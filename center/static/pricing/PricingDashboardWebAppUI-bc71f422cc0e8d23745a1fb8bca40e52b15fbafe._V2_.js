(function(h){var l=window.AmazonUIPageJS||window.P,q=l._namespace||l.attributeErrors,d=q?q("PricingDashboardWebAppUI"):l;d.guardFatal?d.guardFatal(h)(d,window):d.execute(function(){h(d,window)})})(function(h,l,q){h.when("A","3p-amcharts","graph-library","state-library","ready","current-tab-dashboard").execute(function(d,a,f,k){f.prepareGraph("bbwinDetailsPageState","bbwin-graph")});h.when("A","state-library").execute("tab-state",function(d,a){var f=a.getCurrentTab();h.register("current-tab-"+
f,null)});h.when("A","jQuery","ready").execute("navigation-module",function(d,a){var f=d.state("navigationState");h.when("current-tab-price-alerts").execute("alerts-hack",function(){a("a[href='"+f.myiPriceAlertsPreferencesUrl+"']").click(function(a){a.preventDefault();l.location.href=f.priceAlertsPreferencesUrl})});h.when("current-tab-price-alerts-preferences").execute("alerts-preferences-hack",function(){a("a[href='"+f.myiPriceAlertsUrl+"']").click(function(a){a.preventDefault();l.location.href=
f.priceAlertsUrl});a("<input>").attr({name:"redirectUrl",type:"hidden",value:f.priceAlertsUrl}).appendTo("#preferencesForm")});h.when("current-tab-manage-pricing").execute("manage-pricing-hack",function(){a("a[href='"+f.myiManagePricingPreferencesUrl+"']").click(function(a){a.preventDefault();l.location.href=f.managePricingPreferencesUrl})});h.when("current-tab-manage-pricing-preferences").execute("manage-pricing-preferences-hack",function(){a("a[href='"+f.myiManagePricingUrl+"']").click(function(a){a.preventDefault();
l.location.href=f.managePricingUrl});a("<input>").attr({name:"redirectUrl",type:"hidden",value:f.managePricingUrl}).appendTo("#preferencesForm")});h.when("current-tab-madagascar-confirm-action").execute("madagascar-confirm-action-hack",function(){a("span#interstitialPageDiscontinue a").click(function(a){a.preventDefault();l.location.href=d.state("myiPricingMetadata").redirectUrl})})});h.when("A","jQuery","nudges-library","ready","current-tab-dashboard").execute("nudge-expander-ready",
function(d,a,f){a(".see-all-nudges").click(function(a){a.preventDefault();f.seeAllNudgesHandler()});a(".nudge-table").delegate(".nudge-action-update:not(.disabled)","click",function(){f.nudgeActionUpdateHandler(this);return!1});a(".nudge-table").delegate(".nudge-action-match:not(.disabled)","click",function(){f.nudgeActionMatchHandler(this);return!1});a(".nudge-table").delegate(".nudge-action-skip:not(.disabled)","click",function(){f.nudgeActionSkipHandler(this);return!1});d.on("pcd:nudge:completeNudge",
function(a){f.completeNudge(a)});f.refreshNudgeTable(!1,!0);f.bootstrapNudgeIndices()});h.when("A","jQuery","popovers-library","state-library","ready","current-tab-dashboard").execute("popovers-ready",function(d,a,f,k){a("body").delegate(".update-popover-update","click",function(a){a.preventDefault();f.setNudgeActionsEnabled(!1);a=f.getNudgeKeyFromButton(this);d.state(a);var k=f.getNewPrice(a),h=f.getUpdatePopoverName(a);f.isValidPrice(k)?f.doPriceUpdate(h,a,k,!1):(f.showInvalidPriceError(a),
f.focusNewPrice(a))});a("body").delegate(".update-popover-new-price","input propertychange paste",function(a){a=this.getAttribute("data-nudge-key");f.hideInvalidPriceError(a)});a("body").delegate(".update-popover-cancel","click",function(a){a.preventDefault();f.getNudgeKeyFromButton(this);f.hideDisplayedPopovers()});a("body").delegate(".update-confirm-popover-ok","click",function(a){a.preventDefault();f.getNudgeKeyFromButton(this);f.hideDisplayedPopovers()});d.on("pcd:popover:hideDisplayedPopovers",
function(){f.hideDisplayedPopovers()});d.on("pcd:popover:registerPopoverHandlers",function(){f.registerPopoverHandlers()});d.on("pcd:popover:showMatchPopover",function(a,d){f.createMatchPopover(a,d)});d.on("pcd:popover:showUpdatePopover",function(a,d){f.createUpdatePopover(a,d)});f.registerPopoverHandlers();k.initPriceUpdateState()});h.when("A","jQuery","state-library","ready","current-tab-dashboard").execute(function(d,a,f){function k(f,k){var h=d.state(f),c=h.arrowClass;d.objectIsEmpty(c)?
(c=a("#"+k).find(".no-data"),c.find(".summary-number").html("--")):(c=a("#"+k).find("."+c),c.find(".summary-number").html(h.mostRecentValue));c.show()}k("pciDetailsPageState","summary-pci");k("bbwinDetailsPageState","summary-bbwin");k("salesConversionDetailsPageState","summary-nosale");f.isPromotionEnabled()&&k("promotionDetailsPageState","summary-promotion");(function(){d.get(f.getAjaxUrlForPromotionNudgeCount(),{params:{},cache:!1,chunk:function(d){var f=d[1];if("set-promotion-nudge-count"===d[0])a("#feePromotionCount").replaceWith(f);
else throw"Unsupported AJAX operation";},success:function(){a("#feePromotionCountSpinner").addClass("hidden");a("#feePromotionCount").removeClass("hidden")},error:function(){a("#feePromotionCountSpinner").addClass("hidden");a("#feePromotionCount").removeClass("hidden")}})})()});h.when("A","jQuery","toggle-library","ready","current-tab-dashboard").register("toggle",function(d,a,f){a("#summary-pci").click(function(){f.toggleToView("pci-view","pci-dashboard",this,"pciDetailsPageState","pci-graph")});
a("#summary-bbwin").click(function(){f.toggleToView("bbwin-view","bbwin-dashboard",this,"bbwinDetailsPageState","bbwin-graph")});a("#summary-nosale").click(function(){f.toggleToView("nosale-view","nosale-dashboard",this,"salesConversionDetailsPageState","salesconversion-graph")});a("#summary-promotion").click(function(){f.toggleToView("promotion-view","promotion-dashboard",this,"promotionDetailsPageState",null)})});h.when("A","state-library","popovers-library","metrics-library","nudges-library",
"jQuery","ready").register("metrics-bindings",function(d,a,f,k,h,n){function l(a){return c(a.getAttribute("data-nudge-key"))}function c(b){var c=h.getNudgeIndex(b);b=a.getNudge(b);b.nudgeIndex=c;return b}function b(a){a=f.getNudgeKeyFromButton(a);return f.getNewPrice(a)}n(".nudge-table").delegate(".nudge-action-update","click",function(){k.logNudgeAction("nudge-update-open-popover",l(this))});n(".nudge-table").delegate(".nudge-action-match","click",function(){var a=l(this);k.logNudgeAction("nudge-match",
a,f.calculateMatchPrice(a.offerPrice,h.getSuggestedPriceForNudge(a)))});n(".nudge-table").delegate(".nudge-action-skip","click",function(){k.logNudgeAction("nudge-skip",l(this))});n("body").delegate(".update-popover-update","click",function(a){a.preventDefault();k.logNudgeAction("nudge-update-update",c(f.getNudgeKeyFromButton(this)),b(this))});n("body").delegate(".update-popover-cancel","click",function(a){a.preventDefault();k.logNudgeAction("nudge-update-cancel",c(f.getNudgeKeyFromButton(this)),
b(this))});n("body").delegate(".update-confirm-popover-ok","click",function(a){a.preventDefault();k.logNudgeAction("nudge-update-confirm-ok",c(f.getNudgeKeyFromButton(this)))});n(".details-graph").one("mouseover",function(){k.logAction("hover",this.id)});n("#pcd-parent-container").delegate(".tracked-link","click",function(){k.logAction("click",this.id)});n("#pcd-parent-container").delegate(".summary-container","click",function(){d.$(this).hasClass("clickable")&&k.logAction("click",this.id)})});
h.when("A","jQuery","3p-amcharts","ready","current-tab-dashboard").register("graph-library",function(d,a,f){function k(a){a={precision:a,decimalSeparator:".",thousandsSeparator:","};var b=new f.AmGraph;b.valueField="value";b.numberFormatter=a;b.lineThickness=2;b.lineColor="#FF6600";b.connect=!1;b.bullet="round";b.bulletSize=1;b.balloonText="[[value]]%<br><span class='tooltip-fraction-string'>[[tooltipFractionString]]</span>";return b}function h(a){var b=new f.ValueAxis;b.precision=0;for(var e=100,
d=0,k=0;k<a.length;k++){var u=parseFloat(a[k].value);isNaN(u)||(u<e&&(e=u),u>d&&(d=u))}a=Math.round(parseFloat(e));0<a?(e=a%10,a=0===e?a-10:a-e):a=0;b.minimum=a;d=Math.round(parseFloat(d));100>d?(a=d%10,d=0===a?d+10:d+(10-a)):d=100;b.maximum=d;b.autoGridCount=!1;b.gridCount=6;b.axisThickness=0;b.tickLength=0;b.labelFunction=l;return b}function n(){var a=new f.ChartCursor;a.zoomable=!1;a.cursorColor="#555";a.categoryBalloonColor="#AAA";return a}function l(a,b,d){return a===d.min&&0<=a||a===d.max&&
100>=a?a+"%":""}return{prepareGraph:function(a,b){var e=d.state(a).graphDataList,g=d.state(a).precision;if(null!==e&&e!==q){var l=new f.AmSerialChart;l.dataProvider=e;l.categoryField="dateString";l.addGraph(k(g));l.addChartCursor(n());l.addValueAxis(h(e));e=l.categoryAxis;e.autoGridCount=!1;e.gridCount=4;e.gridThickness=0;e=l.balloon;e.borderThickness=1;e.borderColor="#DDD";e.borderAlpha=0;e.fillAlpha=.9;e.fillColor="#FCFCFC";e.shadowAlpha=.2;l.write(b)}}}});h.when("A","jQuery","state-library",
"nudges-library","ready","current-tab-dashboard").register("metrics-library",function(d,a,f,k){function h(b){a.extend(b,E);b.dashboardView=f.getCurrentDashboardView();b.actionTimestamp=(new Date).getTime();l.ue.log(b,"pcd-metrics")}function n(a){var b="";d.objectIsEmpty(a)||d.objectIsEmpty(a.amount)||(b=a.amount);return b}var q=d.state("pageVisitMetadata"),c=f.tryGetPageState("pciDetailsPageState"),b=f.tryGetPageState("bbwinDetailsPageState"),e=f.tryGetPageState("salesConversionDetailsPageState"),
g=a("#price-alerts-link").attr("data-error-count"),E={merchantID:q.merchantID,customerID:q.customerID,pciNumerator:parseInt(c.numerator,10),pciDenominator:parseInt(c.denominator,10),pciArrowClass:c.arrowClass,mostRecentPCIValue:parseInt(c.mostRecentValue,10),pricingErrorCount:parseInt(g,10),mostRecentBBWinValue:parseInt(b.mostRecentValue,10),mostRecentSalesConversionValue:parseInt(e,10)};return{logNudgeAction:function(a,b,c){var d=b.offerPrice,e=k.getSuggestedPriceForNudge(b);a={action:a,sku:b.merchantSKU,
asin:b.asin,index:b.nudgeIndex,oldItemPrice:n(d.itemPrice),oldShippingPrice:n(d.shippingPrice),suggestedItemPrice:n(e.itemPrice),suggestedShippingPrice:n(e.shippingPrice),numberOfSalesIn30Days:b.numberOfSalesIn30Days,filteredOfferCount:b.filteredOfferCount,filteredLowLandedPrice:n(b.filteredLowestLandedPrice),condition:b.condition,fulfillmentChannel:b.fulfillmentChannel};c&&(a.newItemPrice=c,a.newShippingPrice=n(d.shippingPrice));f.getNudgeTableConfiguration("isPointsEnabled")&&(a.oldPointsValue=
d.points);h(a)},logAction:function(a,b){h({action:a,elementId:b})}}});h.when("A","jQuery","state-library","ready").register("nudges-library",function(d,a,f){function k(){var a=f.getNudgeTableState("pageToken");return!!d.objectIsEmpty(a)}function h(b){b.forEach(function(b){a("#netProceeds-spinner-"+b.nudgeKey).addClass("hidden");a("#netProceeds-"+b.nudgeKey).removeClass("hidden")})}function n(c){a(".nudge-row-container[data-nudge-key='"+c+"']").addClass("nudge-done");A(!1);f.getNudgeTableConfiguration("nudgeDisplayCount");
c=f.getNudgeTableConfiguration("nudgeRefreshCount");var d=f.getNudgeTableConfiguration("nudgeFetchCount");g().length<c&&!k()&&null===F&&r(d,!1);c=b().length;k()&&0===c&&X()}function q(a){return"BuyBox.MatchBuyBox"===f.getActiveNudgeType()?a.buyBoxWinnerPrice:a.suggestedLowPrice}function c(){return a(".nudge-table tbody .nudge-row-container")}function b(){return a(".nudge-row-container:not(.nudge-done, .hidden)")}function e(b){return a(".nudge-row-container[data-nudge-key='"+b+"']")}function g(){return a(".nudge-row-container:not(.nudge-done)")}
function E(){a(".active-view .nudge-table-loading-row").addClass("hidden")}function u(){a(".active-view .see-all-nudges").addClass("hidden")}function t(b,c){var e=f.getNudge(b).nudgeID;d.get("/hz/pcd/ajax/skip-nudge",{params:{nudgeID:e,skipUseCase:c},success:function(b){f.refreshIfNecessary(a(b))}});e=d.delay(function(){n(b)},f.getNudgeTableConfiguration("skipNotificationDuration"));w.push(e)}function r(e,g,h){if(h||!k()){var m=f.getNudgeTableState("pageToken"),z=b().length,l=f.getNudgeTableConfiguration("nudgeDisplayCount");
(z<l||g)&&a(".active-view .nudge-table-loading-row").removeClass("hidden");F=d.get(f.getAjaxUrlForNudgeRetrieval(),{params:{pageToken:m,fetchCount:e,toggling:h},cache:!1,chunk:function(b){var d=b[1];switch(b[0]){case "update-nudge-table-state":f.setNudgeTableState(d);break;case "add-nudge-popovers":a(".active-view .nudge-popovers-container").append(d);p(d);break;case "add-nudge-row":var e=(b=0===c().length)?0:parseInt(c().last().attr("data-nudge-index"),10)+1;(b?a(".active-view .nudge-table-header"):
c().last()).after(d);c().last().attr("data-nudge-index",e);p(d);break;case "update-nudge-key-list":f.setNudgeKeyList(d);break;default:throw"Unsupported AJAX operation";}},success:function(b){f.refreshIfNecessary(a(b))||("FeePromotion.LandedPriceFee"===f.getActiveNudgeType()&&J(),E(),d.trigger("pcd:popover:registerPopoverHandlers"),A(g,h),F=null,"FeePromotion.LandedPriceFee"===f.getActiveNudgeType()&&B())},error:function(){h&&a(".active-view .nudge-error-row").removeClass("hidden");E()}})}}function A(d,
e){z(c());m(c());var h=f.getNudgeTableConfiguration("nudgeDisplayCount"),h=d?g():g().slice(0,h);W(h);h=b().length;k()&&0===a(".nudge-row-container.hidden").length?u():(e||"FeePromotion.LandedPriceFee"===f.getActiveNudgeType())&&a(".active-view .see-all-nudges").removeClass("hidden");k()&&0===h&&a(".active-view .nudge-error-row").hasClass("hidden")&&X()}function z(b){a(b).each(function(){var b=this.getAttribute("data-nudge-key"),c=f.getNudge(b),b=d.objectIsEmpty(c.offerPrice.shippingPrice)?null:parseFloat(c.offerPrice.shippingPrice.amount),
c=parseFloat(q(c).landedPrice.amount);(null===b||0>=c-b)&&a(this).find(".nudge-action-match").addClass("disabled")})}function m(b){a(b).each(function(){var b=this.getAttribute("data-nudge-key");V(b)&&a(this).find(".nudge-action-match").addClass("disabled")})}function V(a){var b=f.getNudge(a);a=parseInt(b.offerPrice.points,10);b=parseInt(q(b).points,10);return f.getNudgeTableConfiguration("isPointsEnabled")&&(0<a||0<b)}function P(b){a(".active-view .nudge-table").find(".nudge-action-update, .nudge-action-match, .nudge-action-skip").attr("data-enabled",
b)}function W(b){a(b).each(function(){a(this).removeClass("hidden")})}function X(){a(".active-view .nudge-table-no-recommendations-row").removeClass("hidden")}function p(b){a(b).find("script").each(function(){f.updateStateFromTag(this)})}function B(){var a=[],b=0;d.state(f.getActiveNudgeType()+"-nudgeKeyList").nudgeKeys.forEach(function(c){var d=f.getNudge(c),e={};e.nudgeKey=c;e.asin=d.asin;e.promotionDetails=d.promotionDetails;e.suggestedPrice=d.suggestedLowPrice;a.push(e);10<=++b&&(Y(a),a=[],b=
0)});0<b&&Y(a)}function Y(b){d.post(f.getAjaxUrlForFeePreviews(),{params:{nudgeData:JSON.stringify(b)},chunk:function(b){var c=b[1],d=b[2];switch(b[0]){case "update-net-proceeds-column":a("#netProceeds-"+c).replaceWith(d);break;case "append-nudge-popover":a("#popover-container-"+c).append(d);break;default:throw"Unsupported AJAX operation";}},success:function(){h(b)},error:function(){h(b)}})}function J(){d.state(f.getActiveNudgeType()+"-nudgeKeyList").nudgeKeys.forEach(function(b){var c=f.getNudge(b).promotionDetails.startDate,
d=f.getNudge(b).promotionDetails.endDate,e=Date.parse(c),d=Date.parse(d),d=new Date(d);c&&(c=(new Date(e)).getTimezoneOffset(),e=d.getTimezoneOffset(),c>e?d.setHours(d.getHours()-1):c<e&&d.setHours(d.getHours()+1));a("#feeDiscountDate-"+b).replaceWith(d.toLocaleDateString(d.getTimezoneOffset(),{year:"numeric",month:"short",day:"numeric"}))})}var F=null,w=[];return{bootstrapNudgeIndices:function(){c().each(function(a){this.setAttribute("data-nudge-index",a)})},completeNudge:n,getDisplayedNudges:b,
getSuggestedPriceForNudge:q,getNudgeIndex:function(a){return e(a).attr("data-nudge-index")},nudgeActionUpdateHandler:function(b){if("false"!==a(b).attr("data-enabled")){var c=b.getAttribute("data-nudge-key");d.trigger("pcd:popover:hideDisplayedPopovers");V(c)?(b=f.getNudge(c).merchantSKU,l.open("/hz/pricing/manage-pricing?sku="+b),t(c,"pointsOfferUpdate")):d.trigger("pcd:popover:showUpdatePopover",b,c)}},nudgeActionMatchHandler:function(b){if("false"!==a(b).attr("data-enabled")){P(!1);var c=a(b).attr("data-nudge-key");
d.trigger("pcd:popover:hideDisplayedPopovers");d.trigger("pcd:popover:showMatchPopover",b,c)}},nudgeActionSkipHandler:function(b){if("false"!==a(b).attr("data-enabled")){P(!1);b=a(b).attr("data-nudge-key");d.trigger("pcd:popover:hideDisplayedPopovers");var c=e(b);a(c).find("td").hide();a(c).find(".nudge-row-skip-alert").show();t(b,"default");P(!0)}},refreshNudgeTable:A,seeAllNudgesHandler:function(){u();null!==F&&(F.abort(),F=null);W(g());var a=f.getNudgeTableConfiguration("maxNudgeDisplayCount");
r(a,!0)},setNudgeActionsEnabled:P,toggle:function(){null!==F&&(F.abort(),F=null);w.forEach(function(a){clearTimeout(a)});w=[];a(".nudge-row-container").remove();a(".active-view .nudge-table-no-recommendations-row").addClass("hidden");u();a(".active-view .nudge-error-row").addClass("hidden");var b=f.getNudgeTableConfiguration("nudgeFetchCount");r(b,!1,!0)}}});h.when("A","jQuery","nudges-library","state-library","a-popover","ready").register("popovers-library",function(d,a,f,k,h){function l(a){k.isPriceUpdated(a)&&
d.trigger("pcd:nudge:completeNudge",a);r(!0)}function D(a,b){var c=h.get(a);c.unlock();"true"===c.getContent().find(".price-update-successful").val()?(k.registerPriceUpdate(b),u(a,b)):(c.update({closeButton:!0,dataStrategy:"preload"}).show(),t(a,b),c.getContent().find(".update-popover-invalid-price").removeClass("hidden"))}function c(a){a=h.get(a);a.unlock();a.update({closeButton:"true",dataStrategy:"inline"})}function b(a,b){var c=a.shippingPrice;if(null===c||c===q)return"";c=a.itemPrice.amount-
(a.landedPrice.amount-b.landedPrice.amount);return 0<c?c.toString():""}function e(a,c){var d=k.getNudge(c);g(a,c,b(d.offerPrice,f.getSuggestedPriceForNudge(d)),!0)}function g(a,b,c,d){h.get(a).lock();var e=k.getNudge(b);b=e.asin;var f=e.merchantSKU,g=e.nudgeID,l=e.offerPrice.shippingPrice.amount,e=e.offerPrice.itemPrice.currency;h.get(a).update({closeButton:!1,dataStrategy:"ajax",url:"/hz/pcd/ajax/update-price?"+jQuery.param({asin:b,merchantSKU:f,nudgeID:g,priceAmount:c,shipping:l,currencyCode:e,
isMatch:d})})}function E(a){a=h.get(a);null!==a&&a!==q&&a.isActive()&&a.hide()}function u(b,c){var d=k.getNudge(c),e=h.get(b).getContent();a(e).find(".update-confirm-popover-item-name").html(d.itemName)}function t(a,b){var c=h.get(a),d=k.getNudge(b),e=k.getPriceStrings(b),c=c.getContent();c.find(".update-popover-item-name").html(d.itemName);c.find(".update-popover-your-price").html(e.offerLandedPrice);c.find(".update-popover-your-item-price-plus-shipping").html(e.offerItemPlusShippingPriceString);
c.find(".update-popover-new-price-currency").html(e.currencySymbol);c.find(".update-popover-new-item-shipping").html(e.offerShippingPriceString);c.find("#update-popover-new-price-"+b).focus()}function r(a){f.setNudgeActionsEnabled(a)}return{calculateMatchPrice:b,clearPopovers:function(){a(".nudge-popovers-container").empty();a(".nudge-row-container").each(function(b,c){var d=a(c).attr("data-nudge-key");h.remove("updatePricePopover-"+d);h.remove("matchPricePopover-"+d)});a(".a-popover-preload").remove()},
createMatchPopover:function(b,c){var f=h.create(a(b),d.state("matchPricePopoverActionParams "+c)).show();e(f.name,c)},createUpdatePopover:function(b,c){k.getNudge(c);var e=h.create(a(b),d.state("updatePricePopoverActionParams "+c)).show();t(e.name,c);e.getContent().find(".update-popover-invalid-price").addClass("hidden");e.getContent().find(".update-popover-new-price").val(k.getPriceStrings(c).suggestedMatchPrice)},doPriceMatch:e,doPriceUpdate:g,focusNewPrice:function(b){a("#update-popover-new-price-"+
b).focus()},getNewPrice:function(b){return a("#update-popover-"+b+"-content").find(".update-popover-new-price").val()},getNudgeKeyFromButton:function(b){return a(b).find("input").attr("data-nudge-key")},getUpdatePopoverName:function(a){return"updatePricePopover-"+a},isValidPrice:function(a){var b=/^[\d\.,\s]*$/;a=d.trim(a);return!d.objectIsEmpty(a)&&b.test(a)},hideDisplayedPopovers:function(){a(f.getDisplayedNudges()).each(function(){var b=a(this).attr("data-nudge-key");E("matchPricePopover-"+b);
E("updatePricePopover-"+b)})},hideInvalidPriceError:function(b){a("#update-popover-invalid-price-"+b).addClass("hidden")},initConfirmPopover:u,registerPopoverHandlers:function(){a(".nudge-row-container").each(function(){var b=a(this).attr("data-nudge-key");d.on("a:popover:ajaxContentLoaded:updatePricePopover-"+b,function(a){if(!k.refreshIfNecessary(a.popover.$popover)){var b=a.popover.name.slice(19);D(a.popover.name,b)}});d.on("a:popover:ajaxFail:updatePricePopover-"+b,function(a){c(a.popover.name)});
d.on("a:popover:afterHide:updatePricePopover-"+b,function(a){var b=a.popover.name.slice(19);l(b);a.popover.update({dataStrategy:"preload"})});d.on("a:popover:ajaxContentLoaded:matchPricePopover-"+b,function(a){if(!k.refreshIfNecessary(a.popover.$popover)){var b=a.popover.name.slice(18);D(a.popover.name,b)}});d.on("a:popover:ajaxFail:matchPricePopover-"+b,function(a){c(a.popover.name)});d.on("a:popover:afterHide:matchPricePopover-"+b,function(a){a=a.popover.name.slice(18);l(a)})})},setNudgeActionsEnabled:r,
showInvalidPriceError:function(b){a("#update-popover-invalid-price-"+b).removeClass("hidden")}}});h.when("A","jQuery","ready").register("state-library",function(d,a){return{getCurrentTab:function(){return d.state("tabState").currentTab},getCurrentDashboardView:function(){return d.state("dashboardPageState").currentDashboardView},getAjaxUrlForNudgeRetrieval:function(){return"/hz/pcd/ajax/"+a(".active-view .nudge-table").attr("data-get-rows-url-suffix")},getAjaxUrlForFeePreviews:function(){return"/hz/pcd/ajax/feePreview"},
getAjaxUrlForPromotionNudgeCount:function(){return"/hz/pcd/ajax/promotionNudgeCount"},getNudge:function(a){return d.state(a).nudge},getActiveNudgeType:function(){return a(".active-view .nudge-table").attr("data-nudge-type")},getNudgeTableConfiguration:function(a){return d.state(this.getActiveNudgeType()+"-nudgeTableConfiguration")[a]},getNudgeTableState:function(a){return d.state(this.getActiveNudgeType()+"-nudgeTableState")[a]},getPriceStrings:function(a){return d.state("priceStrings-"+a)},initPriceUpdateState:function(){d.state("priceUpdate",
{})},isPriceUpdated:function(a){return!0===d.state("priceUpdate")[a]},isPromotionEnabled:function(){return!0===d.state("dashboardPageState").isPromotionEnabled},registerPriceUpdate:function(a){var h={};h[a]=!0;d.state("priceUpdate",h)},setNudgeTableState:function(a){d.state.replace(this.getActiveNudgeType()+"-nudgeTableState",a)},setNudgeKeyList:function(a){d.state.replace(this.getActiveNudgeType()+"-nudgeKeyList",a)},updateStateFromTag:function(f){var h=d.parseJSON(a(f).attr("data-a-state")).key;
f=d.parseJSON(a(f).html());d.state.replace(h,f)},setCurrentDashboardView:function(f){var h=a.extend({},d.state("dashboardPageState"));h.currentDashboardView=f;d.state.replace("dashboardPageState",h)},tryGetPageState:function(a){a=d.state(a);return d.objectIsEmpty(a)?{}:a},refreshIfNecessary:function(a){if(a.is("#redirectTag")||0!==a.find("#redirectTag").length)return l.location.reload(),!0}}});h.when("A","jQuery","state-library","graph-library","nudges-library","popovers-library","current-tab-dashboard",
"ready").register("toggle-library",function(d,a,f,h,l,n){return{toggleToView:function(d,c,b,e,g){d!==f.getCurrentDashboardView()&&a(b).hasClass("clickable")&&(a(".summary-container").toggleClass("clickable",!1),a(".summary-container").removeClass("selected"),a(".dashboard-view-content").removeClass("active-view"),a(".dashboard-view-content").hide(),n.clearPopovers(),a("#"+c).show(),a("#"+c).addClass("active-view"),null!==g&&h.prepareGraph(e,g),l.toggle(),f.setCurrentDashboardView(d),a(b).addClass("selected"),
a(".summary-container").toggleClass("clickable",!0))}}})});