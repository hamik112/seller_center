/*
 Copyright 2013, Amazon.com, Inc. or its affiliates
 Copyright 2013, Amazon.com, Inc. or its affiliates
*/
(function(l){var m=window.AmazonUIPageJS||window.P,k=m._namespace||m.attributeErrors,c=k?k("SellerCentralJsonJavascript"):m;c.guardFatal?c.guardFatal(l)(c,window):c.execute(function(){l(c,window)})})(function(l,m,k){l.register("JSON",function(){function c(a){return 10>a?"0"+a:a}function g(e){a.lastIndex=0;return a.test(e)?'"'+e.replace(a,function(a){var e=f[a];return"string"===typeof e?e:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function d(a,b){var c,f,k,l,m=e,t,r=b[a];
r&&"object"===typeof r&&"function"===typeof r.toJSON&&(r=r.toJSON(a));"function"===typeof n&&(r=n.call(b,a,r));switch(typeof r){case "string":return g(r);case "number":return isFinite(r)?String(r):"null";case "boolean":case "null":return String(r);case "object":if(!r)return"null";e+=h;t=[];if("[object Array]"===Object.prototype.toString.apply(r)){l=r.length;for(c=0;c<l;c+=1)t[c]=d(c,r)||"null";k=0===t.length?"[]":e?"[\n"+e+t.join(",\n"+e)+"\n"+m+"]":"["+t.join(",")+"]";e=m;return k}if(n&&"object"===
typeof n)for(l=n.length,c=0;c<l;c+=1)"string"===typeof n[c]&&(f=n[c],(k=d(f,r))&&t.push(g(f)+(e?": ":":")+k));else for(f in r)Object.prototype.hasOwnProperty.call(r,f)&&(k=d(f,r))&&t.push(g(f)+(e?": ":":")+k);k=0===t.length?"{}":e?"{\n"+e+t.join(",\n"+e)+"\n"+m+"}":"{"+t.join(",")+"}";e=m;return k}}"object"!==typeof JSON&&(JSON={});"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+c(this.getUTCMonth()+
1)+"-"+c(this.getUTCDate())+"T"+c(this.getUTCHours())+":"+c(this.getUTCMinutes())+":"+c(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var b=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,h,f={"\b":"\\b","\t":"\\t","\n":"\\n",
"\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},n;"function"!==typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var f;h=e="";if("number"===typeof c)for(f=0;f<c;f+=1)h+=" ";else"string"===typeof c&&(h=c);if((n=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return d("",{"":a})});"function"!==typeof JSON.parse&&(JSON.parse=function(a,e){function c(a,b){var h,f,d=a[b];if(d&&"object"===typeof d)for(h in d)Object.prototype.hasOwnProperty.call(d,
h)&&(f=c(d,h),f!==k?d[h]=f:delete d[h]);return e.call(a,b,d)}var h;a=String(a);b.lastIndex=0;b.test(a)&&(a=a.replace(b,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return h=eval("("+a+")"),"function"===typeof e?c({"":h},""):h;throw new SyntaxError("JSON.parse");});return JSON})});
(function(l){var m=window.AmazonUIPageJS||window.P,k=m._namespace||m.attributeErrors,c=k?k("SellerCentralClassJavascript"):m;c.guardFatal?c.guardFatal(l)(c,window):c.execute(function(){l(c,window)})})(function(l,m,k){l.register("Class",function(){var c=!1,g=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(d){function b(){!c&&this.init&&this.init.apply(this,arguments)}var a=this.prototype;c=!0;var e=new this;c=!1;for(var h in d)e[h]="function"===typeof d[h]&&
"function"===typeof a[h]&&g.test(d[h])?function(e,b){return function(){var c=this._super;this._super=a[e];var h=b.apply(this,arguments);this._super=c;return h}}(h,d[h]):d[h];b.prototype=e;b.prototype.constructor=b;b.extend=arguments.callee;return b};return Class})});
(function(l){var m=window.AmazonUIPageJS||window.P,k=m._namespace||m.attributeErrors,c=k?k("MrTableUI"):m;c.guardFatal?c.guardFatal(l)(c,window):c.execute(function(){l(c,window)})})(function(l,m,k){l.when("A").execute("tabela-remove-touch",function(c){c.$("html").removeClass("a-touch","a-tablet")});l.when("A","Class").register("tabela-base-model",function(c,g){return g.extend({init:function(){}})});l.when("A","tabela-base-model").register("tabela-container-state",function(c,g){var d=c.$;return g.extend({init:function(b){this.myState=
{action:k,pageNumber:0,recordsPerPage:k,sortedColumnId:k,sortOrder:k,searchText:k,tableId:b,filters:k,clientState:{}}},getState:function(){return this.myState},get:function(b){return this.myState[b]},set:function(b,a){if(d.isPlainObject(b))for(var e in b)e in this.myState&&(this.myState[e]=b[e]);else b in this.myState&&(this.myState[b]=a);return this},setClientState:function(b,a){if(d.isPlainObject(b))for(var e in b)this.validateClientState(e,b[e])&&(this.myState.clientState[e]=b[e]);else this.validateClientState(b,
a)&&(this.myState.clientState[b]=a)},validateClientState:function(b,a){if("string"===typeof b&&"string"===typeof a)return!0;throw Error("Tabela: attempted to set client state using invalid name or value.");},removeClientState:function(b){if(b in this.myState.clientState)try{delete this.myState.clientState[b]}catch(a){this.myState.clientState[b]=k}}})});l.when("A","Class").register("tabela-base-view-model",function(c,g){var d=c.$;return g.extend({$element:k,init:function(b){this.validate(b);this.$element=
b},validate:function(b){},replaceHtml:function(b){b=d(b);this.validate(b);this.$element.replaceWith(b);this.$element=b},replaceInnerHtml:function(b){b=d(b);this.$element.html(b)},getDomObject:function(){return this.$element.get(0)}})});l.when("A","tabela-base-view-model","tabela-field-view-model","tabela-public-row-view-model").register("tabela-row-view-model",function(c,g,d,b){var a=c.$;return g.extend({fields:{},init:function(a){this._super(a);this.parseRowContent()},validate:function(a){if(!a.is("tr"))throw Error("Trying to parse non-tr element into a row.");
if(!a.attr("id"))throw Error('Trying to create a row with no attribute "id".');if(!a.hasClass("mt-row"))throw Error('Trying to create a row without the "mt-row" class');},parseRowContent:function(){var e=this;e.fields={};this.$element.children().each(function(b,c){var n=a(c),n=new d(n);if(n.hasSubFields()){var p=n.getSubFields(),u;for(u in p)p.hasOwnProperty(u)&&(e.fields[u]=p[u])}e.fields[n.getFieldId()]=n})},getRowId:function(){return this.$element.attr("id")},removeSelf:function(){this.$element.detach()},
replaceHtml:function(a){this._super(a);this.parseRowContent()},getFieldByColumnId:function(a){return this.fields[a]},getPublicViewModel:function(){return new b(this)}})});l.when("A","Class").register("tabela-public-row-view-model",function(c,g){var d;return g.extend({init:function(b){d=b},getRowData:function(){return d.$element.data("row-data")},getField:function(b){b=d.getFieldByColumnId(b);if(b!==k)return b.getPublicViewModel()}})});l.when("A","tabela-base-view-model","tabela-row-view-model").register("tabela-table-view-model",
function(c,g,d){var b=c.$;return g.extend({rows:[],init:function(a){this._super(b("#"+a).find(".mt-table"));this.parseCurrentTable()},parseCurrentTable:function(){var a=this;a.rows=[];a.$element.find(".mt-row").each(function(e,c){a.rows.push(new d(b(c)))})},replaceHtml:function(a){""!==c.trim(a)&&this.validate(b(a));this.$element.find(".mt-row").detach();this.$element.find("tbody").append(a);this.parseCurrentTable()},findRowIndexByRowId:function(a){for(var e=0;e<this.rows.length;e++)if(this.rows[e].getRowId()===
a)return e;return-1},getRowByIndex:function(a){return 0>a||a>=this.rows.length?k:this.rows[a]},getRowByRowId:function(a){return this.getRowByIndex(this.findRowIndexByRowId(a))},insertRow:function(a,e){if(0>a)return k;var c=new d(b(e)),f;a<this.rows.length?(f=b(this.rows[a].getDomObject()),b(c.getDomObject()).insertBefore(f)):(f=b(this.rows[this.rows.length-1].getDomObject()),b(c.getDomObject()).insertAfter(f));this.rows.splice(a,0,c);return c},removeRow:function(a){if(0>a||a>=this.rows.length)return!1;
this.rows[a].removeSelf();this.rows.splice(a,1);return!0}})});l.when("A","tabela-base-view-model","tabela-public-field-factory").register("tabela-field-view-model",function(c,g,d){var b=c.$,a=g.extend({subFields:{},isSubField:!1,init:function(a,b){this._super(a);"undefined"!==typeof b&&(this.isSubField=b);this.parseFieldContent()},validate:function(a){if(0<a.parent("tr").length&&!a.is("td"))throw Error("Trying to parse non-<td> element into a field.");if(!a.attr("id"))throw Error('Trying to create a field with no attribute "id".');
if(!a.attr("data-row"))throw Error('Trying to create a field with no attribute "data-row".');if(!a.attr("data-column"))throw Error('Trying to create a field with no attribute "data-column".');},getFieldId:function(){return this.$element.attr("data-column")},getSubFields:function(){return this.subFields},parseFieldContent:function(){var e=this;e.subFields={};0!==this.$element.children(".mt-combination").length&&this.$element.children(".mt-combination").children().each(function(c,f){var d=new a(b(f),
!0);e.subFields[d.getFieldId()]=d})},hasSubFields:function(){return!b.isEmptyObject(this.subFields)},replaceHtml:function(a){this.isSubField?this.replaceInnerHtml(b(a).html()):(this._super(a),this.parseFieldContent())},getPublicViewModel:function(){return(new d).getField(this)}});return a});l.when("A","Class").register("tabela-public-base-field",function(c,g){return g.extend({$element:k,replaceHtml:k,getFieldId:k,hasSubFields:k,init:function(c){this.$element=c.$element;this.replaceHtml=c.replaceHtml;
this.getFieldId=c.getFieldId;this.hasSubFields=c.hasSubFields},getFieldType:function(){return"BASE_FIELD"}})});l.when("A","tabela-public-base-field").register("tabela-public-declarative-base-field",function(c,g){return g.extend({init:function(c){this._super(c);this.$declarative=this.$element.children(".a-declarative")},hasDeclarativeAction:function(){return 0<this.$declarative.length?!0:!1},getDeclarativeActionNames:function(){return this.hasDeclarativeAction()?this.$declarative.attr("data-action").split(" "):
""},getDeclarativeActionData:function(c){return this.hasDeclarativeAction()?this.$declarative.data(c):k}})});l.when("A","tabela-public-base-field").register("tabela-public-combination-field",function(c,g){var d=c.$;return g.extend({subFields:{},init:function(b){var a=this;a._super(b);d.each(b.subFields,function(e,b){a.subFields[e]=b.getPublicViewModel()})},getFieldType:function(){return"COMBO_FIELD"}})});l.when("A","tabela-public-base-field").register("tabela-public-editable-field",function(c,g){return g.extend({getFieldType:function(){return"EDITABLE_FIELD"},
setVal:function(c){this.$element.find(".mt-input-text").val(c).trigger("change")}})});l.when("A","tabela-public-base-field").register("tabela-public-text-field",function(c,g){return g.extend({getFieldType:function(){return"TEXT_FIELD"},replaceText:function(c){this.$element.find(".mt-text-content").text(c)}})});l.when("A","tabela-public-declarative-base-field").register("tabela-public-link-field",function(c,g){return g.extend({getFieldType:function(){return"LINK_FIELD"},replaceText:function(c){this.$element.find(".mt-link-content").text(c)},
getText:function(){return this.$element.find(".mt-link-content").text()},replaceUri:function(c){this.$element.find(".mt-link-content").attr("href",c)},getUri:function(){return this.$element.find(".mt-link-content").attr("href")}})});l.when("A","Class","tabela-public-base-field","tabela-public-combination-field","tabela-public-editable-field","tabela-public-text-field","tabela-public-link-field").register("tabela-public-field-factory",function(c,g,d,b,a,e,h){return g.extend({getField:function(c){return c.hasSubFields()?
new b(c):0<c.$element.children(".mt-editable-text").length?new a(c):0<c.$element.children(".mt-text").length?new e(c):0<c.$element.find(".mt-link").length?new h(c):new d(c)}})});l.when("A","Class").register("tabela-base-handler",function(c,g){var d=c.$;return g.extend({container:k,containerState:k,actions:{},enabled:!1,init:function(b,a,e){this.container=b;this.containerState=a;this.$container=d("#"+b);this.actions=e;this.createListener();this.enabled=!0},createListener:function(){var b=this,a;for(a in this.actions)this.actions.hasOwnProperty(a)&&
"function"!==typeof this.actions[a]&&c.declarative(this.container+"-"+a,this.actions[a],function(a){return b.baseHandleEvent.call(b,a)})},baseHandleEvent:function(b){this.handleEvent(b);this.shouldTriggerRefresh(b)&&this.doRefresh(b);return this.postHandleEvent(b)},doRefresh:function(b){var a=this;b={container:a.container,originalEvent:b,changeType:a.getHandlerType(),refreshCallback:function(e){a.serverRefreshCallback.call(a,e)}};c.trigger("tabela:state-change",b);c.trigger("tabela:state-change:"+
a.container,b)},handleEvent:function(b){},shouldTriggerRefresh:function(b){return!1},serverRefreshCallback:function(b){},postHandleEvent:function(b){return!1},getHandlerType:function(){return"UNKNOWN_HANDLER"},getState:function(b){return{}},allowRefresh:function(b){return!0},isEnabled:function(){return this.enabled},find:function(b){return d(b,this.$container)}})});l.when("A","Class","tabela-base-handler").register("tabela-split-dropdown-handler",function(c,g,d){var b=c.$;return d.extend({init:function(a,
e){this._super(a,e,{});var b=this;c.on("a:splitdropdown:select",function(a){b.handleDropdownEvent.call(b,a)})},handleDropdownEvent:function(a){if(0!==a.$select.parents("#"+this.container).length)if(a=b("option#"+a.value),"GET"===a.attr("data-action-type"))a.attr("data-action-target")===k||""===a.attr("data-action-target")||"_top"===a.attr("data-action-target")?m.location=a.attr("data-action-string"):m.open(a.attr("data-action-string"),a.attr("data-action-target"));else if("POST"===a.attr("data-action-type")){var e=
b("<form>");e.attr("method","post");e.attr("action",a.attr("data-action-string"));e.submit()}else"EVENT"===a.attr("data-action-type")&&(e=a.attr("data-action-string"),a={container:this.container,recordId:a.attr("data-record"),eventName:e},c.trigger(e,a))}})});l.when("A","Class","tabela-base-handler","tabela-split-dropdown-handler").register("tabela-save-dropdown-handler",function(c,g,d,b){var a=c.$;return b.extend({handleDropdownEvent:function(e){var b=a("option#"+e.value);"SAVE"===b.attr("data-action-type")&&
(e=a.extend(!0,{},e,{action:"save-dropdown",container:this.container,isSingleRow:!0,saveType:"save-row",$selected:b}),c.trigger("tabela:save-row",e),c.trigger("tabela:save-row:"+this.container,e))}})});l.when("A","Class","tabela-base-handler").register("tabela-edit-handler",function(c,g,d){var b=c.$,a=[];return d.extend({pendingChanges:[],watchedActions:{"inline-changed":["keyup","change"]},init:function(a,h){var f=this;this._super(a,h,this.watchedActions);this.$container=b("#"+a);c.on("tabela:table-refresh-done:"+
f.container,function(a){f.removePendingChanges()});c.on("a:dropdown:select",function(a){a=f.translateDropdownEvent(a);a.data.row&&f.handleEvent(a)})},translateDropdownEvent:function(e){var c=b("#"+b(e.nativeItemNode).data("rootnode")),f=c.data("metadata")||null,d=c.data("record"),c=c.data("column"),p=e.value;a[d]||(a[d]=[]);var u=a[d][c];a[d][c]=p;e={$target:b(e.auiItemNode),data:{original:u,row:d,col:c,metadata:f}};e.$target.val=function(){return p};return e},handleEvent:function(a){a.$target.val()!==
a.data.original?(this.addPendingChange(a.data.row,a.data.col,a.$target.val(),a.data.original,a.data.metadata),a.$target.addClass("mt-input-changed")):(this.removePendingChange(a.data.row,a.data.col),a.$target.removeClass("mt-input-changed"));this.hasPendingChanges()?this.triggerCellsEdited():this.triggerEditedCleared();this.handleChangeEvent()},handleChangeEvent:function(){b(".mt-row").removeClass("mt-has-change");for(var a=0;a<this.pendingChanges.length;a++)b("#"+this.pendingChanges[a].recordId+
".mt-row").addClass("mt-has-change")},findPendingChange:function(a,b){for(var c=0;c<this.pendingChanges.length;c++)if(this.pendingChanges[c].recordId===a){for(var d=0;d<this.pendingChanges[c].updatedFields.length;d++)if(this.pendingChanges[c].updatedFields[d].fieldId===b)return{row:c,col:d};return{row:c,col:-1}}return{row:-1,col:-1}},addPendingChange:function(a,c,b,d,p){var u=this.findPendingChange(a,c);-1!==u.row?-1!==u.col?this.pendingChanges[u.row].updatedFields[u.col].changedValue=b:(a={fieldId:c,
changedValue:b,beforeValue:d},null!==p&&(a.metadata=p),this.pendingChanges[u.row].updatedFields.push(a)):(u={recordId:a,updatedFields:[{fieldId:c,changedValue:b,beforeValue:d}]},null!==p&&(u.updatedFields[0].metadata=p),this.pendingChanges.push(u))},removePendingChange:function(a,c){var b=this.findPendingChange(a,c);-1!==b.row&&(-1!==b.col&&this.pendingChanges[b.row].updatedFields.splice(b.col,1),0===this.pendingChanges[b.row].updatedFields.length&&this.pendingChanges.splice(b.row,1))},removePendingRowChange:function(a){a=
this.findPendingChange(a,k);-1!==a.row&&this.pendingChanges.splice(a.row,1)},removePendingChanges:function(a){"undefined"===typeof a?(this.pendingChanges=[],this.triggerEditedCleared(),b(".mt-input-changed").removeClass("mt-input-changed")):(this.removePendingRowChange(a),this.hasPendingChanges()||this.triggerEditedCleared(),b("#"+a+" .mt-input-changed").removeClass("mt-input-changed"));this.handleChangeEvent()},hasPendingChanges:function(){return 0<this.pendingChanges.length},getHandlerType:function(){return"EDIT_CHANGED"},
getState:function(a){if("undefined"===typeof a)return this.pendingChanges;a=this.findPendingChange(a,k);return-1===a.row?[]:[this.pendingChanges[a.row]]},triggerEditedCleared:function(){var a={container:this.container};c.trigger("tabela:edited-cleared",a);c.trigger("tabela:edited-cleared:"+this.container,a)},triggerCellsEdited:function(){var a={container:this.container};c.trigger("tabela:cells-edited",a);c.trigger("tabela:cells-edited:"+this.container,a)},allowRefresh:function(a){a=this.$container.find(".unsaved-changes-confirm-label").val();
if(this.hasPendingChanges()&&!confirm(a))return!1;this.removePendingChanges();return!0}})});l.when("A","Class","tabela-base-handler").register("tabela-expander-handler",function(c,g,d){var b=c.$;return d.extend({dataSelector:"",watchedActions:{"fetch-rows":["click"]},init:function(a,e){this._super(a,e,this.watchedActions);this.dataSelector=this.container+"-fetch-rows";var b=this;c.on("tabela:fetch-rows-done:"+this.container,function(a){"success"===a.status&&b.modifyIcon(a)})},handleEvent:function(a){var e=
a.$currentTarget.data(this.dataSelector);b(".mt-variation-icon","#"+a.data.rowId,"#"+this.container).hasClass("mt-variation-expand")?e.fetchedRowIds?(c.each(e.fetchedRowIds,function(a){b("#"+a).show()}),this.modifyIcon(a)):m.TabelaManager.get(this.container).fetchRows(e.endpoint,e.rowId,{position:"after"}):e.fetchedRowIds&&(c.each(e.fetchedRowIds,function(a){b("#"+a).hide()}),this.modifyIcon(a))},modifyIcon:function(a){if(a.data.rowId){var e=b(".mt-variation-icon","#"+a.data.rowId,"#"+this.container);
e.hasClass("mt-variation-expand")?e.removeClass("mt-variation-expand").addClass("mt-variation-collapse"):e.removeClass("mt-variation-collapse").addClass("mt-variation-expand");if(a.fetchedRowIds){var c=e.parent().data(this.dataSelector);c.fetchedRowIds=a.fetchedRowIds;e.parent().data(this.container+"-fetch-rows",c)}}},getHandlerType:function(){return"EXPANDER"},shouldTriggerRefresh:function(a){return!1}})});l.when("A","Class","tabela-base-handler","a-popover").register("tabela-filter-handler",function(c,
g,d,b){function a(a){return-1!==a.action.indexOf("filter-changed")}function e(a,e){for(var b=0;b<e.length;b++)if(e[b].filterGroupId===a)return b;return-1}function h(a,b,c,h){var f=e(a,h);-1===f?h.push({filterGroupId:a,filterCriteria:[{value:c,filterId:b}]}):h[f].filterCriteria.push({value:c,filterId:b})}function f(a,b){var c=e(a,b);-1!==c&&b.splice(c,1)}function n(a,e,b){var c;a.find(".a-declarative input").each(function(a,e){"checkbox"===p(e).attr("type")?p(e).removeAttr("checked"):"radio"===p(e).attr("type")&&
("true"===p(e).parent().attr("data-is-default")?(p(e).prop("checked",!0),c=p(e).val()):p(e).prop("checked",!1))});f(e,b);c&&h(e,c,"true",b)}var p=c.$;return d.extend({selectedFilters:[],$container:k,watchedActions:{"filter-changed":["change"],"filtergroup-clear-clicked":["click"],"filter-clear-clicked":["click"]},delay:0,delayEventId:null,init:function(a,e){var h=this;0!==p("#"+a).find(".mt-filter-container").length&&(h._super(a,e,h.watchedActions),h.setupInitialState(),c.on("tabela:table-refresh-done:"+
h.container,function(a){h.find(".mt-filter > .a-declarative").each(function(a,e){var c=b.get(e);"undefined"!==typeof c&&null!==c&&c.isActive()&&c.updatePosition()})}))},handleEvent:function(e){a(e)&&this.handleFilterClick(e);-1!==e.action.indexOf("filtergroup-clear-clicked")&&this.handleFilterGroupClearClick(e);-1!==e.action.indexOf("filter-clear-clicked")&&this.handleFilterClearClick(e);"true"===this.$container.find(".mt-enable-floating-bar").val()&&this.find(".mt-filter > .a-declarative").each(function(a,
e){var c=b.get(e);"undefined"!==typeof c&&null!==c&&c.hide()})},handleFilterClick:function(a){if("checkbox"===a.$target.attr("type"))if(a.$target.is(":checked"))h(a.data.filterGroupId,a.data.filterId,"true",this.selectedFilters);else{var c=a.data.filterId,b=this.selectedFilters;a=e(a.data.filterGroupId,b);if(-1!==a){a:{for(var d=b[a].filterCriteria,p=0;p<d.length;p++)if(d[p].filterId===c){c=p;break a}c=-1}-1!==c&&b[a].filterCriteria.splice(c,1)}0===b[a].filterCriteria.length&&b.splice(a,1)}else"radio"===
a.$target.attr("type")?(f(a.data.filterGroupId,this.selectedFilters),h(a.data.filterGroupId,a.data.filterId,"true",this.selectedFilters)):"hidden"===a.$target.attr("type")&&(f(a.data.filterGroupId,this.selectedFilters),h(a.data.filterGroupId,a.data.filterId,"true",this.selectedFilters))},handleFilterGroupClearClick:function(a){n(a.$target.parents(".mt-filter-popup-container"),a.data.filterGroupId,this.selectedFilters)},handleFilterClearClick:function(a){this.find(".mt-filter-popup-container .a-declarative input").each(function(a,
e){"checkbox"===p(e).attr("type")&&p(e).removeAttr("checked")});this.selectedFilters=[]},setupInitialState:function(){var a=this;this.$container.find('.mt-filter-group [data-action*="filter-changed"]').each(function(e,c){var b=p(c),f=b.data(a.container+"-filter-changed"),b=b.find("input");("checkbox"===b.attr("type")||"radio"===b.attr("type"))&&b.is(":checked")&&h(f.filterGroupId,f.filterId,"true",a.selectedFilters)})},getState:function(){return this.selectedFilters},getHandlerType:function(){return"FILTER_CHANGED"},
shouldTriggerRefresh:function(e){return!a(e)||0===this.delay},postHandleEvent:function(e){if(a(e)&&0<this.delay){var b=this;null!==this.delayEventId&&m.clearTimeout(this.delayEventId);this.delayEventId=m.setTimeout(function(){b.doRefresh(e)},this.delay)}return!1},setDelay:function(a){this.delay=a}})});l.when("A","Class","tabela-base-handler").register("tabela-filter-button-handler",function(c,g,d){var b=c.$;return d.extend({selectedFilters:[],watchedActions:{"filter-button-clicked":["click"]},init:function(a,
e){var h=this;this._super(a,e,this.watchedActions);c.on("tabela:table-refresh-done:"+this.container,function(a){h.find(".mt-filter-num-select").text(b("#"+a.container).find(".mt-selected-filter").length)});this.find(".mt-filter-num-select").text(b("#"+a).find(".mt-selected-filter").length)},handleEvent:function(a){a=this.$container.find(".mt-header-filter-button-container");var e=b("#mt-floating-bar").find(".mt-header-filter-button-container");a.add(e).toggleClass("expanded");a.hasClass("expanded")?
(c.slideDown(this.$container.find(".mt-filter-container"),300),c.slideDown(b("#mt-floating-bar").find(".mt-filter-container"),300)):(c.slideUp(this.$container.find(".mt-filter-container"),300),c.slideUp(b("#mt-floating-bar").find(".mt-filter-container"),300))},getState:function(){return[]},getHandlerType:function(){return"FILTER_BUTTON_CLICKED"},shouldTriggerRefresh:function(a){return!1},postHandleEvent:function(a){return!1}})});l.when("A","Class","tabela-base-handler").register("tabela-floating-bar-handler",
function(c,g,d){var b=c.$;return d.extend({$container:k,createFloatingBar:!1,watchedActions:{},init:function(a,e){var h=this;h.$container=b("#"+a);"true"===h.$container.find(".mt-enable-floating-bar").val()&&(h._super(a,e,h.watchedActions),h.reload(),c.on("tabela:data-changed",function(a){h.reload()}),c.on("tabela:ajax-request-done",function(a){h.setWidths()}),c.on.load(function(){h.setWidths()}),c.on.resize(function(){h.setWidths()}),b(m).scroll(function(){h.updateTableHeaders()}))},reload:function(){b("#mt-floating-bar").remove();
var a;a=b(".mt-header").clone();a.addClass("floatingHeaderBar");a.find("[id]").each(function(){this.id+="-floating"});a.find(".a-popover-preload").each(function(){this.parentNode.removeChild(this)});a.find(":input").each(function(){this.name+="-floating"});b("#a-page").after('<div id="mt-floating-bar" />');b("#mt-floating-bar").append(a);a=b("#head-row").clone();a.attr("id","floatingHeaderColumns");a.addClass("floatingHeaderColumns");a.find("[id]").each(function(){this.id+="-floating"});b("#mt-floating-bar").append('<table class="floatingHeaderTable mt-table a-bordered a-horizontal-stripes" />');
b(".floatingHeaderTable").append(a);this.setWidths()},setWidths:function(){var a=b("#floatingHeaderColumns");b(".floatingHeaderBar");var e=b("#mt-floating-bar"),c=b("#head-row"),f=c.offset().left,d=c.outerWidth();e.css({width:d,left:f});a.find("th").each(function(){var a=this.id.split("-")[0];b(this).css("width",b("#"+a).outerWidth())});a.width(c.width());this.updateTableHeaders()},updateTableHeaders:function(){var a=b(".mt-header").offset(),e=b(m).scrollTop(),c=-b(m).scrollLeft(),f=b("#mt-floating-bar");
e>a.top-30?(f.css({display:"inline",top:"0px",left:c+a.left}),"none"!==this.find(".mt-filter-button-selected").css("display")&&this.find(".mt-header-filter-button-container").first().find(".a-button-text").click()):f.css({display:"none"})}})});l.when("A","Class","tabela-base-handler").register("tabela-pagination-handler",function(c,g,d){var b=c.$;return d.extend({currentPage:1,triggerRefresh:!0,watchedActions:{"page-clicked":["click"],"page-changed":["click"]},init:function(a,e){this._super(a,e,this.watchedActions);
this.updateCurrentPage();this.triggerRefresh=!0;var b=this;c.on("tabela:table-refresh-done:"+this.container,function(a){b.updateCurrentPage()})},handleEvent:function(a){a.$event.preventDefault();this.triggerRefresh=!0;var e=b("#"+this.container+"-gotopage");this.getPaginationHandler(a).call(this,e,a)},getPaginationHandler:function(a){return-1!==a.action.indexOf("page-changed")?this.skipToPageHandler:this.pageClickedHandler},skipToPageHandler:function(a){var e=parseInt(a.val(),10);parseInt(b(".mt-num-page").val(),
10)>=e&&0<e?(this.currentPage=e,a.removeClass("a-form-error")):(a.addClass("a-form-error"),this.triggerRefresh=!1)},pageClickedHandler:function(a,e){if("#next"===e.$target.attr("href"))this.currentPage++;else if("#prev"===e.$target.attr("href"))this.currentPage--;else{var b=e.$target.attr("href");this.currentPage=parseInt(b.substr(1),10)}1===a.length&&(a.removeClass("a-form-error"),a.val(this.currentPage))},getState:function(){return this.currentPage},setState:function(a){this.currentPage=parseInt(a,
10)},getHandlerType:function(){return"PAGE_CHANGED"},shouldTriggerRefresh:function(a){return this.triggerRefresh},hasPagination:function(){return 0<b(".mt-pagination","#"+this.container).length},updateCurrentPage:function(){this.hasPagination()?this.currentPage=parseInt(b(".mt-pagination .mt-current-page","#"+this.container).val(),10):this.currentPage=1}})});l.when("A","Class","tabela-base-handler").register("tabela-records-per-page-handler",function(c,g,d){var b=c.$;return d.extend({recordsPerPage:0,
triggerRefresh:!1,watchedActions:{"records-per-page-select-changed":["change"]},init:function(a,e){0<b(".mt-records-per-page","#"+a).length&&(this._super(a,e,this.watchedActions),this.container=a,this.recordsPerPage=parseInt(b(".mt-current-records-per-page","#"+this.container).val(),10))},handleEvent:function(a){a=b(a.$target.find("option:selected"));parseInt(a.val(),10)===this.recordsPerPage?this.triggerRefresh=!1:(this.recordsPerPage=parseInt(a.val(),10),this.triggerRefresh=!0)},getState:function(a){return this.enabled?
this.recordsPerPage:k},getHandlerType:function(){return"RECORDS_PER_PAGE_CHANGED"},shouldTriggerRefresh:function(a){return this.triggerRefresh},serverRefreshCallback:function(a){this.recordsPerPage=parseInt(b(".mt-current-records-per-page","#"+this.container).val(),10)}})});l.when("A","Class","tabela-base-handler").register("tabela-save-all-handler",function(c,g,d){var b=c.$;return d.extend({watchedActions:{"saveall-clicked":["click"]},buttonEnabled:!0,init:function(a,e){this._super(a,e,this.watchedActions);
var b=this;c.on("tabela:cells-edited:"+this.container,function(a){return b.enableButton.call(b,a)});c.on("tabela:edited-cleared:"+this.container,function(a){return b.disableButton.call(b,a)});this.disableButton()},handleEvent:function(a){var e=this.container;this.buttonEnabled&&(a=b.extend(!0,{},a,{container:e,saveType:"save-all"}),c.trigger("tabela:save-all",a),c.trigger("tabela:save-all:"+e,a))},disableButton:function(a){b(".mt-button-saveall").addClass("a-button-disabled");this.buttonEnabled=!1},
enableButton:function(a){b(".mt-button-saveall").removeClass("a-button-disabled");this.buttonEnabled=!0}})});l.when("A","Class","tabela-base-handler").register("tabela-savebutton-handler",function(c,g,d){var b=c.$;return d.extend({watchedActions:{"save-button":["click"]},init:function(a,e){this._super(a,e,this.watchedActions)},handleEvent:function(a){a=b.extend(!0,{},a,{action:"save-button",container:this.container,isSingleRow:!0,saveType:"save-row",$selected:a.$target});c.trigger("tabela:save-row",
a);c.trigger("tabela:save-row:"+this.container,a)}})});l.when("A","Class","tabela-base-handler").register("tabela-search-handler",function(c,g,d){var b=c.$;return d.extend({watchedActions:{"search-submit":["submit"],"search-text-changed":["keyup","change"]},init:function(a,e){0<b(".mt-search","#"+a).length&&this._super(a,e,this.watchedActions)},handleEvent:function(a){a.$event.preventDefault();if(-1!==a.action.indexOf("search-text-change")){var e=a.$target.attr("id");-1!==e.indexOf("floating")?b("#"+
e.substring(0,e.indexOf("-floating"))).val(a.$target.val()):b("#"+e+"-floating").val(a.$target.val())}},getState:function(){return this.enabled?b("#"+this.container+"-search").val():k},setState:function(a){b("#"+this.container+"-search").val(a)},getHandlerType:function(){return"SEARCH_CHANGED"},shouldTriggerRefresh:function(a){return-1!==a.action.indexOf("search-text-change")?!1:!0}})});l.when("A","Class","tabela-base-handler").register("tabela-sort-handler",function(c,g,d){var b=c.$;return d.extend({currentColumn:k,
sortingOrder:0,watchedActions:{"sort-clicked":["click"]},sortOrders:["DESCENDING","ASCENDING"],init:function(a,e){this._super(a,e,this.watchedActions);var c=b('.mt-header-sort-icon[data-sorted="true"]');0<c.length&&(this.currentColumn=c.attr("data-column"),this.sortingOrder=b.inArray(c.attr("data-direction"),this.sortOrders))},handleEvent:function(a){a.data.heading===this.currentColumn?this.sortingOrder=(this.sortingOrder+1)%this.sortOrders.length:(this.currentColumn=a.data.heading,this.sortingOrder=
0);this.modifySortIcon(a)},modifySortIcon:function(a){b(".mt-header-sort-icon, .mt-header-sort","#"+this.container).removeClass("mt-sort-up mt-sort-down");b(".mt-header-sort-icon, .mt-header-sort","#mt-floating-bar").removeClass("mt-sort-up mt-sort-down");a="mt-sort-up";"DESCENDING"===this.sortOrders[this.sortingOrder]&&(a="mt-sort-down");var e=b("[data-column = "+this.currentColumn+"]");e.addClass(a);e.parents(".mt-header-sort").addClass(a)},getState:function(){return{column:this.currentColumn,order:this.sortOrders[this.sortingOrder]}},
setState:function(a){this.currentColumn=a.sortedColumnId;this.sortingOrder="DESCENDING"===a.sortOrder?0:1;this.modifySortIcon(b("#"+this.currentColumn).find("span.a-declarative"))},getHandlerType:function(){return"SORT_CHANGED"},shouldTriggerRefresh:function(a){return!0}})});l.when("A","Class","tabela-base-handler").register("tabela-bulk-action-handler",function(c,g,d){var b=c.$;return d.extend({$container:k,watchedActions:{"row-select-changed":["change"],"row-select-all-changed":["change"],"bulk-action-select-changed":["change"]},
allowMultiPage:!1,selectedRows:{},init:function(a,e){var h=this;h.$container=b("#"+a);0<h.$container.find(".mt-header-bulk-action .a-button-dropdown").length&&("true"===h.$container.find(".mt-allow-multi-page-select").val()&&(h.allowMultiPage=!0),h._super(a,e,h.watchedActions),h.setDropdownString(),h.setDropdownStatus(),c.on("tabela:table-refresh-done:"+h.container,function(a){h.clearSelectAllCheckbox();h.reselectCheckboxes();h.setDropdownString();h.setDropdownStatus()}))},handleEvent:function(a){-1!==
a.action.indexOf("row-select-all-changed")&&(a.$target.is(":checked")?this.$container.find('.mt-row-select input[type="checkbox"]').attr("checked","checked"):this.$container.find('.mt-row-select input[type="checkbox"]').removeAttr("checked"),this.setFloatingBarSelection());-1!==a.action.indexOf("row-select-changed")&&(a.$target.is(":checked")||this.clearSelectAllCheckbox(),0===this.$container.find(".mt-row-select input:checkbox:not(:checked)").length&&this.checkSelectAllCheckbox());-1!==a.action.indexOf("bulk-action-select-changed")&&
this.handleBulkActionChanged(a);this.setDropdownString();this.setDropdownStatus()},handleBulkActionChanged:function(a){var e=a.$target,h=b(e.find("option:selected"));b(a.$currentTarget.find(".a-dropdown-prompt"));var f=this;e.val(0);setTimeout(function(){var a=h.attr("data-action-string");c.trigger(a,f.getSelectedRows())},0)},clearSelection:function(){this.selectedRows={};this.reselectCheckboxes();this.$container.find('.mt-row-select input[type="checkbox"]').removeAttr("checked")},clearSelectAllCheckbox:function(){this.$container.find("#mt-select-all").removeAttr("checked");
b("#mt-floating-bar").find("#mt-select-all-floating").removeAttr("checked")},checkSelectAllCheckbox:function(){this.$container.find("#mt-select-all").attr("checked","checked");b("#mt-floating-bar").find("#mt-select-all-floating").attr("checked","checked")},setFloatingBarSelection:function(){var a=b("#mt-select-all-floating");this.$container.find("#mt-select-all").attr("checked")?a.attr("checked","checked"):a.removeAttr("checked")},setDropdownString:function(){var a=this.$container.find(".mt-header-bulk-action .a-button-dropdown"),
e=a.data("text"),a=a.data("replace"),c=this.$container.find(".mt-header-bulk-action .a-dropdown-prompt"),f=b("#mt-floating-bar").find(".mt-header-bulk-action .a-button-dropdown");f.data("text");var f=f.data("replace"),d=b("#mt-floating-bar").find(".mt-header-bulk-action .a-dropdown-prompt");c.text(e.replace(a,this.getNumSelectedRows()));d.text(e.replace(f,this.getNumSelectedRows()))},setDropdownStatus:function(){var a=this.$container.find(".mt-header-bulk-action .a-button-dropdown"),e=this.$container.find(".mt-header-bulk-action .a-native-dropdown"),
c=b("#mt-floating-bar").find(".mt-header-bulk-action .a-button-dropdown"),f=b("#mt-floating-bar").find(".mt-header-bulk-action .a-native-dropdown");this.hasSelectedRows()?(a.add(c).removeClass("a-button-disabled"),e.add(f).removeAttr("disabled")):(a.add(c).addClass("a-button-disabled"),e.add(f).attr("disabled","disabled"))},getSelectedRows:function(){if(this.allowMultiPage){var a=[];this.syncSelectedRows();for(var e in this.selectedRows)this.selectedRows[e]!==k&&this.selectedRows.hasOwnProperty(e)&&
a.push({recordId:e,data:this.selectedRows[e]})}else a=[],this.$container.find('.mt-row-select input[type="checkbox"]:checked').each(function(e,c){a.push(b(c).val())});return a},hasSelectedRows:function(){return 0<this.getSelectedRows().length},getNumSelectedRows:function(){return this.getSelectedRows().length},getHandlerType:function(){return"ROW_SELECT_CHANGED"},getState:function(a){return"undefined"===typeof a?this.enabled?this.getSelectedRows():[]:this.enabled?this.$container.find('.mt-row-select input[value="'+
a+'"]').is(":checked"):!1},syncSelectedRows:function(){var a=this;a.$container.find('.mt-row-select input[type="checkbox"]').each(function(e,c){var f=b(c);if(f.is(":checked")){var d=b(f.parents(".a-declarative")).data(a.container+"-row-select-changed").data;a.selectedRows[f.val()]=d}else a.selectedRows[f.val()]!==k&&(a.selectedRows[f.val()]=k,delete a.selectedRows[f.val()])})},reselectCheckboxes:function(){var a=this;a.allowMultiPage&&(a.$container.find('.mt-row-select input[type="checkbox"]').each(function(e,
c){var f=b(c);a.selectedRows[f.val()]!==k?f.attr("checked","checked"):f.removeAttr("checked")}),0===a.$container.find(".mt-row-select input:checkbox:not(:checked)").length&&a.checkSelectAllCheckbox())},allowRefresh:function(a){if(this.allowMultiPage)return this.syncSelectedRows(),!0;a=this.$container.find(".selected-rows-confirm-label").val();return this.hasSelectedRows()&&!confirm(a)?!1:!0}})});l.when("A","Class","tabela-base-handler").register("tabela-delayed-records-handler",function(c,g,d){var b=
c.$,a={},e={};return d.extend({delayedRecords:[],$container:k,init:function(h,f){this._super(h,f,{});this.$container=b("#"+this.container);this.maxRetries=parseInt(this.$container.data("max-retries"),10)||10;var d=this;c.on.ready(function(){c.delay(function(){d.gatherAndSendDelayedRecords.call(d)},20)});c.on("tabela:data-changed:"+h,function(a){d.gatherAndSendDelayedRecords.call(d)});c.on("tabela:data-inserted:"+h,function(a){d.gatherAndSendDelayedRecords.call(d)});c.on("tabela:table-refresh-begin:"+
h,function(c){a={};e={}});c.on("tabela:save-begin:"+h,function(c){a={};e={}})},getState:function(a){return this.delayedRecords},gatherAndSendDelayedRecords:function(){var d=this,f=0;d.clearDelayedRecords();d.$container.find(".mt-delay-loading").each(function(c,n){var g=b(n),k=g.parents(".mt-cell"),l=g.data("field-data"),k=k.attr("data-row"),g=g.parent().attr("data-column");e[k+":"+g]=1;!a[k+":"+g]||a[k+":"+g]<d.maxRetries?d.addDelayedField(k,g,l):e[k+":"+g]=0;1===e[k+":"+g]&&a[k+":"+g]>f&&(f=a[k+
":"+g])});if(d.hasDelayedFields()){c.each(d.delayedRecords,function(a){var e=b.find("tr#"+a.recordId)[0];if(e=b(e).data("delayed-row-data"))a.recordData=e});var n={container:d.container,action:"load-delayed",highestAttemptNumber:f};c.trigger("tabela:load-delayed-rows",n);c.trigger("tabela:load-delayed-rows:"+d.container,n)}},clearDelayedRecords:function(){this.delayedRecords=[]},findDelayedField:function(a,e){for(var c=0;c<this.delayedRecords.length;c++)if(this.delayedRecords[c].recordId===a){for(var b=
0;b<this.delayedRecords[c].delayedFields.length;b++)if(this.delayedRecords[c].delayedFields[b].fieldId===e)return{row:c,col:b};return{row:c,col:-1}}return{row:-1,col:-1}},addDelayedField:function(e,c,b){var d=this.findDelayedField(e,c);"/hz/inventory"===m.location.pathname.substr(0,13)&&"object"!==typeof b&&(b="Exception: the data-field-data attribute of "+e+":"+c+" was malformed and could not be converted into a JSON object");a[e+":"+c]=++a[e+":"+c]||1;-1!==d.row?-1!==d.col?this.delayedRecords[d.row].delayedFields[d.col].fieldData=
b:this.delayedRecords[d.row].delayedFields.push({fieldId:c,fieldData:b}):this.delayedRecords.push({recordId:e,delayedFields:[{fieldId:c,fieldData:b}]})},hasDelayedFields:function(){return 0<this.delayedRecords.length}})});l.when("Class").register("tabela-base-controller",function(c){return c.extend({init:function(){}})});l.when("A","JSON","tabela-container-state","tabela-base-controller","tabela-pagination-handler","tabela-expander-handler","tabela-records-per-page-handler","tabela-sort-handler",
"tabela-search-handler","tabela-split-dropdown-handler","tabela-save-dropdown-handler","tabela-save-all-handler","tabela-savebutton-handler","tabela-edit-handler","tabela-bulk-action-handler","tabela-delayed-records-handler","tabela-filter-button-handler","tabela-filter-handler","tabela-floating-bar-handler").register("tabela-record-controller",function(c,g,d,b,a,e,h,f,n,p,u,l,w,x,y,z,t,r,A){var q=c.$;return b.extend({containerState:k,refreshEndpoint:"",saveEndpoint:"",delayedEndpoint:"",loadingRequests:0,
isSaving:!1,reftagEnabled:!0,ajaxRequestNumber:0,init:function(c,b,C){this.containerState=new d(c);this.container=c;this.$container=q("#"+c);var v=this.containerState;this.handlers={"floating-bar":new A(c),pagination:new a(c,v),"fetch-rows":new e(c,v),"records-per-page":new h(c,v),sort:new f(c,v),search:new n(c,v),"save-dropdown":new u(c,v),"save-button":new w(c,v),"split-dropdown":new p(c,v),"save-all":new l(c,v),edit:new x(c,v),"bulk-action":new y(c,v),"delayed-records":new z(c,v),"filter-button":new t(c),
filter:new r(c)};this.utils=b;this.viewModels=C;this.tableViewModel=this.viewModels.table;this.refreshEndpoint=q(".refresh-endpoint","#"+c).val();this.saveEndpoint=q(".save-endpoint","#"+c).val();this.delayedEndpoint=q(".delayed-endpoint","#"+c).val();this.createListener(c)},createListener:function(a){var e=this;c.on("tabela:state-change:"+a,function(a){for(var c in e.handlers)if(e.handlers.hasOwnProperty(c)&&!e.handlers[c].allowRefresh(a))return;return e.handleStateChange.call(e,a,a.refreshCallback)});
c.on("tabela:save-all:"+a,function(a){return e.handleSave.call(e,a)});c.on("tabela:save-row:"+a,function(a){return e.handleSave.call(e,a)});c.on("tabela:load-delayed-rows:"+a,function(a){return e.handleDelayedLoad.call(e,a)})},scrollOnReload:function(){var a=q("#"+this.container).data("scroll-on-refresh");""!==a&&q(a).get(0).scrollIntoView()},showLoading:function(){0<this.loadingRequests?this.loadingRequests++:q(".mt-loading-overlay","#"+this.container).show()},hideLoading:function(){this.loadingRequests--;
0<this.loadingRequests||q(".mt-loading-overlay","#"+this.container).hide()},unselectAllRows:function(){this.handlers["bulk-action"].clearSelection()},isMarkerEnabled:function(){return"object"===typeof this.utils.markerFactory},getMarkerMachine:function(a){if(this.isMarkerEnabled())return this.utils.markerFactory.getInstance(a)},isReftagEnabled:function(){return this.reftagEnabled},setReftagEnabled:function(a){this.reftagEnabled=a},setDelayBeforeFiltering:function(a){this.handlers.filter.setDelay(a)},
getEndpoint:function(a,e){if(this.isReftagEnabled()){var c=this.utils.reftagUtil,b=c.getReftag(c.fromTag,e);a=c.combineReftagAndUrl(a,b)}return a},getContainerState:function(){var a=this.handlers.sort.getState();this.containerState.set({pageNumber:this.handlers.pagination.getState(),recordsPerPage:this.handlers["records-per-page"].getState(),sortedColumnId:a.column,sortOrder:a.order,searchText:this.handlers.search.getState(),filters:this.handlers.filter.getState()});return this.containerState.getState()},
setClientState:function(a,e){var b=this;"object"===typeof a?(c.each(a,function(a,e){b.handlers[e].setState?b.handlers[e].setState(a):b.containerState.setClientState(e,a)}),b.getContainerState()):b.containerState.setClientState(a,e)},removeClientState:function(a){this.containerState.removeClientState(a)},insertRows:function(a,e,b){var d=this;if("before"!==b&&"after"!==b&&"end"!==b)throw Error('Position must be defined as either "before" or "after" or "end".');var f=d.tableViewModel.findRowIndexByRowId(a),
h=[];"after"===b?f++:"end"===b&&(f=d.tableViewModel.rows.length);q("<table>"+e+"</table>").find("tr.mt-row").each(function(a,e){var c=d.tableViewModel.insertRow(f,e.outerHTML);h.push(c.getRowId());f++});a={container:d.container,insertedRows:h};c.trigger("tabela:data-inserted",a);c.trigger("tabela:data-inserted:"+d.container,a);return h},removeRows:function(a){var e;q.isArray(a)||(a=[a]);for(var c=0;c<a.length;c++)e=this.tableViewModel.findRowIndexByRowId(a[c]),this.tableViewModel.removeRow(e);return!0},
handleStateChange:function(a,e){var b=this,d,f;"undefined"!==typeof a.originalEvent&&"undefined"!==typeof a.originalEvent.action&&(f=a.originalEvent.action);f=b.getEndpoint(b.refreshEndpoint,f);this.containerState.set({action:a.changeType});b.showLoading();if(this.isMarkerEnabled()){var h="ajax"+b.ajaxRequestNumber++;d=b.getMarkerMachine(h);d.beforeAjax()}h={container:b.container};c.trigger("tabela:table-refresh-begin",h);c.trigger("tabela:table-refresh-begin:"+b.container,h);q.ajax({type:"POST",
url:f,contentType:"application/json",dataType:"html",data:g.stringify(b.getContainerState()),success:function(a,e,c){a=b.utils.responseParserFactory.getInstance(a);"undefined"!==typeof d&&d.responseReceived(a.getRequestId());a.isSuccessful()?(b.dataRefresh(a),b.scrollOnReload()):b.showError.call(b,a.getMessage());"undefined"!==typeof d&&d.responseLoaded()},error:function(){b.showError.call(b,k,-1)},complete:function(d,f){0===d.status&&""===d.getAllResponseHeaders()&&location.reload();b.hideLoading();
e(a);var h={container:b.container,status:f},p=d.responseText;"success"!==f&&"error"!==f||!b.utils.responseParserFactory.isTabelaResponse(p)||(p=b.utils.responseParserFactory.getInstance(p),h.responseParser=p);c.trigger("tabela:table-refresh-done",h);c.trigger("tabela:table-refresh-done:"+b.container,h);c.trigger("tabela:ajax-request-done",h);c.trigger("tabela:ajax-request-done:"+b.container,h)}})},handleSave:function(a,e){var b=this,d;if(!b.isSaving){b.isSaving=!0;var f;"save-row"===a.saveType&&(f=
a.$selected.attr("data-action-string"));var h=b.getCurrentEdits(f),p=b.getEndpoint(b.saveEndpoint,a.action);b.showLoading();if(this.isMarkerEnabled()){var n="ajax"+b.ajaxRequestNumber++;d=b.getMarkerMachine(n);d.beforeAjax()}n={container:b.container,saveType:a.saveType,updatedRecords:h.updatedRecords};c.trigger("tabela:save-begin",n);c.trigger("tabela:save-begin:"+b.container,n);q.ajax({type:"POST",url:p,contentType:"application/json",dataType:"html",data:g.stringify(h),success:function(a,e,c){a=
b.utils.responseParserFactory.getInstance(a);"undefined"!==typeof d&&d.responseReceived(a.getRequestId());a.isSuccessful()?(b.handlers.edit.removePendingChanges(f),b.dataRefresh(a)):b.showError(a.getMessage());"undefined"!==typeof d&&d.responseLoaded()},error:function(){b.showError.call(b,k,-1)},complete:function(e,d){b.hideLoading();b.isSaving=!1;var f={container:b.container,status:d,saveType:a.saveType,updatedRecords:h.updatedRecords},p=e.responseText;"success"!==d&&"error"!==d||!b.utils.responseParserFactory.isTabelaResponse(p)||
(p=b.utils.responseParserFactory.getInstance(p),f.responseParser=p);c.trigger("tabela:save-done",f);c.trigger("tabela:save-done:"+b.container,f);c.trigger("tabela:ajax-request-done",f);c.trigger("tabela:ajax-request-done:"+b.container,f)}})}},handleDelayedLoad:function(a){var e=this,b,d=e.delayedEndpoint,f=d.split("?"),d=f[1]?d+("&highestAttemptNumber="+a.highestAttemptNumber):f[0]+"?highestAttemptNumber="+a.highestAttemptNumber,f=e.getCurrentDelayed(),h;a=e.getEndpoint(d+"",a.action);try{h=g.stringify(f)}catch(p){h=
"Exception: Unable to JSON.stringify() the delayed object"}if("/hz/inventory"===m.location.pathname.substr(0,13))try{g.parse(h)}catch(n){h="Exception: Unable to JSON.parse() the JSON.stringified string. Length: "+h.length}this.isMarkerEnabled()&&(d="ajax"+e.ajaxRequestNumber++,b=e.getMarkerMachine(d),b.beforeAjax());d={container:e.container};c.trigger("tabela:delayed-load-begin",d);c.trigger("tabela:delayed-load-begin:"+e.container,d);q.ajax({type:"POST",url:a,contentType:"application/json",dataType:"html",
cache:!1,data:h,success:function(a,c,d){a=e.utils.responseParserFactory.getInstance(a);"undefined"!==typeof b&&b.responseReceived(a.getRequestId());a.isSuccessful()?e.dataRefresh(a,!1):0!==d.readyState&&0!==d.status&&e.showError(a.getMessage());"undefined"!==typeof b&&b.responseLoaded()},error:function(a){0!==a.readyState&&0!==a.status&&e.showError.call(e,k,-1)},complete:function(a,b){var d={container:e.container,status:b},f=a.responseText;"success"!==b&&"error"!==b||!e.utils.responseParserFactory.isTabelaResponse(f)||
(f=e.utils.responseParserFactory.getInstance(f),d.responseParser=f);c.trigger("tabela:delayed-load-done",d);c.trigger("tabela:delayed-load-done:"+e.container,d);c.trigger("tabela:ajax-request-done",d);c.trigger("tabela:ajax-request-done:"+e.container,d)}})},fetchRows:function(a,e,b){var d=this,f;b.showLoading&&d.showLoading();if(this.isMarkerEnabled()){var h="ajax"+d.ajaxRequestNumber++;f=d.getMarkerMachine(h);f.beforeAjax()}h={container:d.container};c.trigger("tabela:table-fetch-rows-begin",h);c.trigger("tabela:table-fetch-rows-begin:"+
d.container,h);var p=[];return q.ajax({type:"POST",url:a,contentType:"application/json",dataType:"html",data:g.stringify(d.getContainerState()),success:function(a,c,h){a=d.utils.responseParserFactory.getInstance(a);"undefined"!==typeof f&&f.responseReceived(a.getRequestId());a.isSuccessful()?(d.$container.find(".mt-table-alerts").html(a.getTableAlerts()),p=d.insertRows(e,a.getItemRecords(),b.position)):d.showError(a.getMessage());"undefined"!==typeof f&&f.responseLoaded()},error:function(){d.showError.call(d,
k,-1)},complete:function(a,f){b.showLoading&&d.hideLoading();var h={container:d.container,status:f,fetchedRowIds:p,data:{rowId:e}},n=a.responseText;"success"!==f&&"error"!==f||!d.utils.responseParserFactory.isTabelaResponse(n)||(n=d.utils.responseParserFactory.getInstance(n),h.responseParser=n);c.trigger("tabela:fetch-rows-done",h);c.trigger("tabela:fetch-rows-done:"+d.container,h);c.trigger("tabela:ajax-request-done",h);c.trigger("tabela:ajax-request-done:"+d.container,h)}})},dataRefresh:function(a,
e){var b=a.getRefreshMode();"undefined"===typeof e&&(e=!0);e?this.$container.find(".mt-table-alerts").html(a.getTableAlerts()):""!==q.trim(a.getTableAlerts())&&this.$container.find(".mt-table-alerts").html(a.getTableAlerts());"TABLE"===b?this.refreshTable(a):"RECORD"===b?(b=q("<table>"+a.getItemRecords()+"</table>"),this.refreshRecord(b)):"FIELD"===b&&(b=q("<table>"+a.getItemRecords()+"</table>"),this.refreshField(b));b={container:this.container};c.trigger("tabela:data-changed",b);c.trigger("tabela:data-changed:"+
this.container,b)},refreshTable:function(a){this.tableViewModel.replaceHtml(a.getItemRecords());this.$container.find(".mt-filter-selected-container").html(a.getSelectedFilters());q("#mt-floating-bar").find(".mt-filter-selected-container").html(a.getSelectedFilters());var e=a.getFilters();if(e){var b=this.$container.find(".mt-filter-container").attr("style");this.$container.find(".mt-header-filters").html(e);this.$container.find(".mt-filter-container").attr("style",b)}this.$container.find(".mt-foot-pagi").html(a.getPagination());
this.handlers.pagination.enabled&&this.handlers.pagination.updateCurrentPage();this.handlers["records-per-page"].enabled&&a.hasRecordsPerPage()&&this.$container.find(".mt-current-records-per-page").val(a.getRecordsPerPage());e=a.getRecordCount();this.$container.find("#mt-header-count-value").text(e);q("#mt-header-count-value-floating").text(e);b=this.$container.find(".mt-foot-skiptopage");1===b.length&&b.html(0<e?a.getSkipToPage():"")},refreshRecord:function(a){var e=this;a.find("tr.mt-row").each(function(a,
b){var c=q(b);e.tableViewModel.getRowByRowId(c.attr("id")).replaceHtml(b.outerHTML)})},refreshField:function(a){var e=this;a.find("tr.mt-row").each(function(a,b){var c=q(b),d=e.tableViewModel.getRowByRowId(c.attr("id"));q.extend(d.$element.data().rowData,c.data().rowData);c.find("td.mt-cell").each(function(a,e){var b=q(e);d.getFieldByColumnId(b.attr("data-column")).replaceHtml(e.outerHTML)})})},updateRowData:function(a,e){var b=this.tableViewModel.getRowByRowId(a).$element.data().rowData,c=e.find("#"+
a).data().rowData;q.extend(b,c)},showError:function(a,e){var b=this.$container.find(".default-error-message-label").val(),c=this;a&&(b=a);c.$container.find("#mt-default-error-text").text(b);c.$container.find(".mt-default-alert").removeClass("a-hidden");q("body").get(0).scrollIntoView();"undefined"===typeof e&&(e=1E4);-1!==e&&setTimeout(function(){c.$container.find(".mt-default-alert").addClass("a-hidden")},e)},getCurrentEdits:function(a){var e={};e.tableId=this.container;e.updatedRecords=this.handlers.edit.getState(a);
this.containerState.set("action","TABLE_SAVED");e.viewContext=this.getContainerState();return e},triggerTableRefresh:function(a){a={container:this.container,changeType:"CUSTOM_REFRESH",refreshCallback:a||function(){}};c.trigger("tabela:state-change",a);c.trigger("tabela:state-change:"+this.container,a)},getCurrentDelayed:function(){this.containerState.set("action","DELAYED_LOAD");return{tableId:this.container,delayedRecords:this.handlers["delayed-records"].getState(),viewContext:this.containerState.getState()}}})});
l.when("A","Class").register("tabela-util-marker-factory",function(c,g){var d=g.extend({enabled:!1,scope:"",init:function(b){m.ue&&b&&(this.enabled=!0,this.scope=b)},beforeAjax:function(){this.enabled&&m.uet("tc",this.scope)},responseReceived:function(b){""===b&&(this.enabled=!1);this.enabled&&(m.ues("id",this.scope,b),m.ues("t0",this.scope,c.now()),m.ues("ctb",this.scope,"1"))},responseLoaded:function(){this.enabled&&(m.uet("cf",this.scope),m.uet("be",this.scope),m.uex("ld",this.scope))}});return g.extend({getInstance:function(b){return new d(b)}})});
l.when("A","Class").register("tabela-reftag-util",function(c,g){var d=c.$;return g.extend({init:function(b){this.featureSetTag=d(".featureSetTag","#"+b).val()||"xx";this.fromTag=d(".fromTag","#"+b).val()||"xx";this.map={"inline-changed":"line","page-clicked":"pgnb","saveall-clicked":"save","search-submit":"srch","sort-clicked":"sort","save-dropdown":"edit"}},getReftag:function(b,a){var e="cont";if(a){var c=this.map,d;for(d in c)if(-1!==a.indexOf(d,a.length-d.length)){e=c[d];break}}return this.featureSetTag+
"_"+b+"_"+e+"_"+this.fromTag},combineReftagAndUrl:function(b,a){var e=document.createElement("a");e.href=b;""===e.host&&(e.href=e.href);var d;d="";e.protocol&&e.hostname&&(d=e.protocol+"//"+e.hostname+(0<e.port.length&&"0"!==e.port?":"+e.port:""));var f,n;f=("/"===e.pathname.substring(0,1)?"":"/")+e.pathname;d+=f;n=e.search;"undefined"!==typeof a&&(a=c.trim(a),f.match(/^\/hz\//)?n=(0<n.length?n+"&":"?")+"ref_="+a:d=d.replace(/\/*$|$/,"/")+"ref="+a);return d+n+e.hash}})});l.when("A","Class").register("tabela-util-response-parser",
function(c,g){function d(a,e){if(!a.isSuccessful())throw Error("Trying to access "+e+" from a failed response.");if("TABLE"!==a.getRefreshMode())throw Error("Trying to access "+e+" from a non-TABLE response");}function b(a){a=c.trim(a);"#"!==a.charAt(0)&&(a="#"+a);return a}function a(a){a=e("<div>"+a+"</div>");if(0===a.find("#mt-request-id").length)throw Error("Unable to find requestId for response");if(0===a.find("#mt-response-status").length)throw Error("Unable to find the response status");if(0===
a.find("#mt-response-message").length)throw Error("Unable to find the response message");}var e=c.$,h=g.extend({$serverResponse:k,refreshMode:k,status:k,message:k,init:function(a){this.$serverResponse=e("<div>"+a+"</div>");this.status=this.get("mt-response-status");this.message=this.get("mt-response-message");this.isSuccessful()&&(this.validateBasicResponse(),this.refreshMode=this.get("refreshMode"),this.validateTableResponse())},validateBasicResponse:function(){if(!this.has("itemRecords"))throw Error("Item Records was not found in response");
if(!this.has("refreshMode"))throw Error("Refresh Mode was not found in response");},validateTableResponse:function(){if("TABLE"===this.refreshMode){if(!this.has("pagination"))throw Error("Pagination was not found in response");if(!this.has("filter"))throw Error("Filter was not found in response");if(!this.has("recordCount"))throw Error("Record Count was not found in response");if(!this.has("currentPage"))throw Error("Current Page was not found in response");if(!this.has("tableName"))throw Error("Table Name was not found in response");
}},isSuccessful:function(){return"SUCCESS"===this.status},getMessage:function(){return this.message},getRequestId:function(){return this.get("mt-request-id")},getRefreshMode:function(){return this.refreshMode},getItemRecords:function(){if(!this.isSuccessful())throw Error("Trying to access itemRecords from a failed response.");return this.get("itemRecords")},getTableAlerts:function(){if(!this.isSuccessful())throw Error("Trying to access table alerts from a failed response.");return this.get("table-alerts")},
getPagination:function(){d(this,"pagination");return this.get("pagination")},getSelectedFilters:function(){d(this,"selected filter");return c.trim(this.$serverResponse.find("#filter script").html())},getFilters:function(){d(this,"filters");return c.trim(this.$serverResponse.find("#filters script").html())},getRecordsPerPage:function(){d(this,"recordsPerPage");return this.get("recordsPerPage")},hasRecordsPerPage:function(){return this.has("recordsPerPage")},getRecordCount:function(){d(this,"record count");
return this.get("recordCount")},getCurrentPage:function(){d(this,"current page");return this.get("currentPage")},getTableName:function(){d(this,"table name");return this.get("tableName")},getSkipToPage:function(){return this.get("gotopage")},get:function(a){a=b(a);if(!this.has(a))throw Error("Unable to find "+a+" in this response.");a=this.$serverResponse.children(a);var e=a.children(":first");return e.is("script")?c.trim(e.html()):c.trim(a.text())},has:function(a){a=b(a);return 0<this.$serverResponse.children(a).length}});
return g.extend({getInstance:function(e){a(e);return new h(e)},isTabelaResponse:function(e){try{return a(e),!0}catch(b){return!1}},validateServerResponse:function(e){a(e)}})});l.when("A","ready").register("tabela-history-plugin",function(c){return function(g){var d=this,b=c.$;d.o=g;d._updateTableState=function(a){a=function(a,b){var f={};c.each(a,function(c,p){a[p]!==b[p]&&(f[d.change.handlerNames[p]]=c)});return f}(d._getParamValue(d.paramKey,a||m.location.search.substring(1)),d.table.getState());
c.objectIsEmpty(a)||(d.table.setClientState(a),d.table.refreshTable())};d._bindStateListeners=function(){d.events={popState:{event:"popstate",cb:function(a){d._updateTableState()}},stateChange:{event:"tabela:state-change:"+d.tableName,cb:function(a){-1!==c.indexOfArray(d.change.events,a.changeType)&&d._update()}},refresh:{event:"tabela:table-refresh-done:"+d.tableName,cb:function(a){d._update(!0)}}};c.each(d.events,function(a,e){if("popState"===e)b(m).bind(a.event,a.cb);else c.on(a.event,a.cb)})};
d.unbindEvents=function(){c.each(d.events,function(a,e){"popState"===e?b(m).unbind(a.event,a.cb):c.off(a.event,a.cb)})};d._update=function(a){var e="",b=d.table.getState();c.each(d.change.handlerNameList,function(a){var n;1<d.change.keys[a].length?(n={},c.each(d.change.keys[a],function(a){n[a]=b[a]})):n=b[d.change.keys[a][0]];e+=a+":"+encodeURIComponent(d.change.handlers[a](n))+";"});d._pushState(e,a);return e};d._buildHandlers=function(a){var e={handlers:{},handlerNames:{},handlerNameList:[],parsers:{},
keys:{},events:[]};c.each(a,function(a,b){e.handlers[a.handlerName]=a.handler;e.parsers[a.handlerName]=a.parser;e.handlerNames[a.handlerName]=a.handlerName;e.handlerNameList.push(a.handlerName);e.keys[a.handlerName]=a.keys;e.events.push(a.changeEvent)});return e};d._getParamValue=function(a,e){var b=e.split("&"),f=null;c.each(b,function(e,c){var d=b[c].split("="),p=d[1];d[0]===a&&(f=p)});if(f){var n=f.split(";"),p={};c.each(n,function(a,e){var b=n[e].split(":"),c=b[0],b=b[1];c&&(p[c]=d.change.parsers[c](decodeURIComponent(b)))});
return p}};d._pushState=function(a,e){if(d.hasPushState||d.o.refresh){var b=d._rebuildURL(m.location.search,m.location.hash,d.paramKey,a);!d.hasPushState&&d.o.refresh?m.location.href="https://"+m.location.host+m.location.pathname+b:e&&history.replaceState?history.replaceState(null,document.title,b):history.pushState(null,document.title,b)}};d._rebuildURL=function(a,e,b,d){d=b+"="+d;""===a?a="?"+d:c.contains(a,b)?(b=new RegExp("([?&])"+b+"=.*?(&|$)","i"),a=a.replace(b,"$1"+d+"$2")):a=a+"&"+d;return a+
e};d.o.refresh=function(a){return"string"===typeof a&&"true"===a.toLowerCase()||"string"===typeof a&&"1"===a||"boolean"===typeof a&&!0===a||"number"===typeof a&&1===a?!0:!1}(d.o.refresh);d.table=d.o.table;d.tableName=d.table.getInstanceName();d.paramKey="tbla_"+d.tableName;d.change=d._buildHandlers(d.o.handlers);d.hasPushState=!1;m.history&&history.pushState&&(d.hasPushState=!0);d._bindStateListeners();d.hasPushState&&d._update(!0)}});l.when("A","ready").register("tabela-history-handler-factory",
function(c){function g(a){this.changeEvent=a.changeEvent;this.handler=a.handler;this.parser=a.parser;this.handlerName=a.handlerName;this.keys=a.keys;return this}function d(a){function e(a){return a}function b(a){return JSON.stringify(a)}function c(a){return JSON.parse(a)}var d=1<a.keys.length?!0:!1;a.handler=a.handler||(d?b:e);a.parser=a.parser||(d?c:e);d=null;d=[];a.keys||d.push("keys");a.changeEvent||d.push("changeEvent");a.handlerName||d.push("handlerName");a.parser||d.push("parser function");
a.handler||d.push("handler function");return d=0===d.length?new g(a):"Error creating new HistoryHandler.  Missing key(s): "+d.join(", ")}function b(a){var e=[];c.each(a,function(a,b){e.push(b)});return e}return{create:function(a){return d(a)},handlers:{pagination:d({handlerName:"pagination",keys:["pageNumber"],changeEvent:"PAGE_CHANGED"}),search:d({handlerName:"search",keys:["searchText"],changeEvent:"SEARCH_CHANGED"}),sort:d({handlerName:"sort",keys:["sortOrder","sortedColumnId"],changeEvent:"SORT_CHANGED"}),
getAllDefaults:function(){var a=this,e=b(this),d=[];e.pop();c.each(e,function(e){d.push(a[e])});return d}},isHistoryHandler:function(a){return a instanceof g}}});l.when("Class","A","tabela-reftag-util","tabela-util-marker-factory","tabela-util-response-parser","tabela-record-controller","tabela-table-view-model","tabela-history-plugin").register("Tabela",function(c,g,d,b,a,e,h,f){var n=g.$;return c.extend({_controllers:k,_viewModels:k,_utils:k,init:function(c){this._container=c;this._utils={reftagUtil:new d(c),
markerFactory:new b,responseParserFactory:new a};this._viewModels={table:new h(c)};this._controllers={};this._controllers.record=new e(c,this._utils,this._viewModels)},setHistoryHandlers:function(a,e){this._tabelaHistory&&(this._tabelaHistory.unbindEvents(),this._tabelaHistory=null);var b=n.extend({table:this,handlers:a},e);this._tabelaHistory=new f(b)},getHistoryUtil:function(){return this._tabelaHistory},getInstanceName:function(){return this._container},getState:function(){return this._controllers.record.getContainerState()},
setClientState:function(a,e){this._controllers.record.setClientState(a,e)},removeClientState:function(a){this._controllers.record.removeClientState(a)},showError:function(a,e){this._controllers.record.showError(a,e)},insertRows:function(a,e,b){return this._controllers.record.insertRows(a,e,b)},removeRows:function(a){return this._controllers.record.removeRows(a)},getResponseParser:function(a){return this._utils.responseParserFactory.getInstance(a)},refreshDataFromResponse:function(a,e){a.isSuccessful()&&
this._controllers.record.dataRefresh(a,e)},showLoading:function(){this._controllers.record.showLoading()},hideLoading:function(){this._controllers.record.hideLoading()},refreshTable:function(a){return this._controllers.record.triggerTableRefresh(a)},unselectAllRows:function(){this._controllers.record.unselectAllRows()},getViewModel:function(a,e){var b=this._viewModels.table.getRowByRowId(a);if(b!==k){if(e===k)return b.getPublicViewModel();b=b.getFieldByColumnId(e);if(b!==k)return b.getPublicViewModel()}},
fetchRows:function(a,e,b){b=n.extend({},{position:"after",showLoading:!0},b);return this._controllers.record.fetchRows(a,e,b)},setConfig:function(a){a=n.extend({},{reftagEnabled:"object"===typeof this._utils.reftagUtil,filterDelay:0},a);this._controllers.record.setReftagEnabled(a.reftagEnabled);this._controllers.record.setDelayBeforeFiltering(a.filterDelay)}})});l.when("Class","Tabela").register("tabela-manager",function(c,g){if("undefined"!==typeof m.TabelaManager)return m.TabelaManager;var d={},
b=c.extend({get:function(a){if("undefined"!==typeof d[a])return d[a];throw Error("Unable to get non-existent Tabela instance ("+a+") from TabelaManager");},create:function(a){if("undefined"===typeof d[a])return d[a]=new g(a),d[a];throw Error("Unable to create Tabela instance and add to TabelaManager: table with same name ("+a+") already exists");}});m.TabelaManager=new b;return m.TabelaManager})});