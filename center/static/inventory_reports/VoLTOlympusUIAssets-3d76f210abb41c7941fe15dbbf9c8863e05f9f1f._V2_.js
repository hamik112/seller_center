(function(h){var m=window.AmazonUIPageJS||window.P,r=m._namespace||m.attributeErrors,e=r?r("VoLTOlympusUIAssets"):m;e.guardFatal?e.guardFatal(h)(e,window):e.execute(function(){h(e,window)})})(function(h,m,r){h.when("A","ready").execute(function(e){e.on("a:tabs:nav-tabs-addproducts:select",function(a){m.location=a.selectedTab.$tab.children("a").first().attr("href")})});h.when("A","jQuery","ready").execute(function(e,a){e.declarative.remove(a("#nav-tabs-addproducts"))});h.when("classification-table-handler").execute(function(e){e.init()});
h.when("A","classification-table-handler").execute(function(e,a){a.populateRecentDocumentsCache()});h.when("A","gating-util").execute(function(e,a){a.init();e.declarative("request-approval","click",function(c){a.requestApproval(c)})});h.when("A","search-handler","gating-util","sanitize-util").execute(function(e,a,c,d){function b(){var b=d.stripTags($("#search-box").val());""!==b&&a.requestSearchData(b)}a.setGatingUtil(c);a.init();e.declarative("search-query","click",function(a){b()});e.declarative("search-query-on-enter",
"keypress",function(a){a=a.$event;13===(a.keyCode?a.keyCode:a.which)&&b()});e.declarative("add-all-results","click",function(b){a.addAllSearchResultsToTable()});e.declarative("add-search-result-to-table","click",function(b){a.addNodeToTable(b.data)})});h.when("A","browse-handler","gating-util").execute(function(e,a,c){a.setGatingUtil(c);a.init();e.declarative("get-child-nodes","click",function(c){a.selectItem(c)})});h.when("A","classification-table-handler").execute(function(e,a){e.declarative("select-node",
"click",function(c){a.addRow(c.data)});e.declarative("empty-table","click",function(c){a.emptyTable()});e.declarative("add-template-to-table","click",function(c){a.emptyTable();a.addTemplateToTable(c.data)})});h.when("A").execute(function(e){e.declarative("clear-search","click",function(a){$("#search-timeout").hide();$("#search-results-container").hide();$("#browse-container").show()})});h.when("A","classification-table-handler","download-handler","please-wait-msg-handler").execute(function(e,a,c,
d){function b(b,e){function k(){c.fileDownload(b.data,{successCallback:e,failCallback:function(a,b){v++;-1!==a.indexOf("empty-merchant-id-header-key")&&3>v?setTimeout(k,25):(d.hidePleaseWait(),$("#download-error").removeClass("hide"))},httpMethod:"POST",data:g})}var v=0;$("#download-error").addClass("hide");var g=a.dumpTableData(),h="none",p=$("#mode-picker-button-group .a-button-selected input").attr("value");p!==r&&(h=p);g["template-type"]=h;0!==g["num-of-nodes"]&&(d.showPleaseWait(),k())}e.declarative("download-custom-template",
"click",function(c){if($("#custom-template-button").hasClass("a-button-disabled"))return d.hidePleaseWait(),!1;b(c,function(b){a.redrawRecentDocuments()});return!1})});h.when("A","ready").register("please-wait-msg-handler",function(e){return{showPleaseWait:function(){var a=jQuery("#pleasewaitbackground"),c=jQuery("#pleasewaitimage");a&&c&&jQuery.browser.msie&&"6.0"===jQuery.browser.version&&jQuery("select").each(function(a,b){jQuery(b).css("visibility","hidden")});a.css("height",jQuery(document).height());
a.css("width",jQuery(document).width());c.css("left",(jQuery(m).width()-100)/2+jQuery(document.body).scrollLeft());c.css("top",(jQuery(m).height()-100)/2+jQuery(document.body).scrollTop());a.css("visibility","visible");c.css("visibility","visible")},hidePleaseWait:function(){var a=jQuery("#pleasewaitbackground"),c=jQuery("#pleasewaitimage");a&&a.css("visibility","hidden");c&&c.css("visibility","hidden")}}});h.when("A","ready").register("ajax-redirect-handler",function(e){return{checkRedirect:function(a){try{var c=
a.split("|");if("redirect"===c[0])return m.location=c[1],!0}catch(d){}return!1}}});h.when("mode-picker").execute(function(e){e.init()});h.when("A","ajax-redirect-handler","ready").register("browse-handler",function(e,a){function c(a,b){d(a,b);n(a);z[a].find(".browse-node").data("level",a);B()}function d(a,c){u();for(var d=a;d<z.length;++d)z[d].empty();if(a>=z.length){L=!0;d=z[0].clone();d.empty();var e=$("<td/>").append(d);z[z.length-1].parent().after(e);z.push(d)}d=z[a];d.append(c);
I=x=a;b(d);p(d)}function b(a){if(null!==w&&w.isActive()){var b=a.find(".browse-node");a=a.find(".leaf-node");w.renderLockingOnJQueryCollection(b,k,h);w.renderLockingOnJQueryCollection(a,f,J)}}function f(a){k(a);var b=$(a).find(".select-button-ungated");a=$(a).find(".gated-button");b.hide();a.show()}function J(a){h(a);var b=$(a).find(".select-button-ungated");a=$(a).find(".gated-button");b.show();a.hide()}function k(a){$(a).find(".lock-icon").show()}function h(a){$(a).find(".lock-icon").hide()}function g(){D()}
function D(){$(".browse-pane").each(function(){var a=$(this);p(a)})}function p(a){a=a.find(".browse-node,.leaf-node");if(0!==a.length){var b=$(a[0]).width();q(b,a)}}function q(a,b){null!==w&&w.isActive()&&b.each(function(){var b=$(this),c=b.find(".node-icon-btn-block"),b=b.find(".browse-node-text");b.css("width","");var d=c.width();b.outerWidth()+d+5>a&&(d=a-c.width(),b.width(d-5));b=(b.height()-c.height())/2;c.css("margin-top",b)})}function l(){if(L){var a=$(z[z.length-1]);p(a);L=!1}}function n(a){for(;E.length>=
a;)E.pop();0<E.length&&E[E.length-1].nextAll().remove();1===a?N.empty():N.append($("<span class='a-icon arrow-right bread-crumb-seperator'/>"));N.find(".last-bread-crumb").removeClass("last-bread-crumb");var b=$("<a/>").html(y);b.click(function(b){r(a);b.preventDefault();return!1});b.addClass("last-bread-crumb");E.push(b);N.append(b)}function B(){var a=T;x<I?a.show():a.hide();a=F;2<x?a.show():a.hide();var a=z.length,b=100*a/3;100<b&&($.browser.webkit||$.browser.safari)&&(b=(10*b+1)/10);A.css("width",
b+"%");a=100/a;A.find("td").width(a+"%");a=100/3*(x-3+1);a*=-1;0<a&&(a=0);b=!0;1<=arguments.length&&(b=arguments[0]);b?A.animate({left:a+"%"},"fast","swing",l):A.css("left",a+"%")}function r(a){a>I&&(a=I);0>a&&(a=0);for(var b=a+1;b<z.length;++b)z[b].empty();for(;E.length>a;)E.pop();0<E.length&&E[E.length-1].nextAll().remove();N.find(".last-bread-crumb").removeClass("last-bread-crumb");E[E.length-1].addClass("last-bread-crumb");z[a].find(".selected-node").removeClass("selected-node");I=x=a;b=!0;2<=
arguments.length&&(b=arguments[1]);B(b)}function t(a){M=setTimeout(function(){a.show()},500)}function u(){null!==M&&(clearTimeout(M),M=null);A.find(".classification-loading-icon").hide()}var H={},w=null,x=null,I=null,z=[],E=[],A=null,F=null,T=null,M=null,N=null,y=null,C=!1,L=!1;return{init:function(){I=x=0;A=$(".browse-carousel");for(var a=0;3>a;a++)z[a]=$("#browse-pane"+(a+1));$(m).resize(g);N=$("#bread-crumb-container");a=z[0];a.find(".browse-node").data("level",0);b(a);A.find("td").width(100/3+
"%");F=$("#scroll-back");T=$("#scroll-forward");F.click(function(){2<x&&x--;B()});T.click(function(){x<I&&x++;B()})},setGatingUtil:function(a){w=a},selectItem:function(b){if(!C){C=!0;var f=b.data;b.$target.closest("td").find(".selected-node").removeClass("selected-node");u();b=b.$target.closest("div");b.addClass("selected-node");var g=b.data("level");y=b.find(".browse-node-text").text();b=b.find(".classification-loading-icon");t(b);H[f]?(C=!1,c(g+1,H[f])):e.post("/listing/productclassifier/browse",
{params:{"selected-node-path":f},timeout:3E4,success:function(b){if(!a.checkRedirect(b)){C=!1;var d=g+1;H[f]=b;c(d,b)}},error:function(){C=!1;var a=g+1,b=$("#browse-timeout").clone();b.removeClass("hide");d(a,b);B()}})}}}});h.when("ready").register("client-logger",function(e){function a(a,d){$.ajax({url:a,type:"POST",contentType:"application/json",data:JSON.stringify([d])})}return{logProperty:function(c,d){a("/listing/log/property",{metric:c,value:d})},logCount:function(c,d){var b={metric:c};
d!==r&&null!==d&&(b.count=d);a("/listing/log/count",b)},logTime:function(c,d){a("listing/log/time",{metric:c,timeMs:d})}}});h.when("A","please-wait-msg-handler","ajax-redirect-handler").register("classification-table-handler",function(e,a,c){function d(a,b,c,d){var e=[],f=!1;$.each(a.browseNodeAttributes,function(a,b){0<b.length&&e.push("<td><span>"+a+"</span></td><td><span>"+b.join(" OR ")+"</span></td>");"item_type_keyword"===a&&(f=!0)});0===e.length&&(e[0]="<td><span> </span></td><td><span> </span></td>");
f&&q(b,a.productTypeDefinitions)||(x[b]="true");var g=1<e.length?" rowspan='"+e.length+"'":"",k=$("<tr class='"+b+"'/>"),l=$("<td"+g+" class='remove-link' />");l.append(c);k.append(l);k.append("<td"+g+"><span>"+a.browseNodeName+"</span></td>");a="";x[b]&&(u||(u="Category ineligible for Custom Template"),a='<div class="a-box a-alert-inline a-alert-inline-warning right"><div class="a-box-inner a-alert-container"><i class="a-icon a-icon-alert"></i><div class="a-alert-content">'+u+"</div></div></div>");
e[0]+="<td"+g+">"+a+"</td>";k.append(e[0]);k.addClass(d);m.find("#header").after(k);for(g=1;g<e.length;g++)a=$("<tr class='"+b+"'>"+e[g]+"</tr>"),a.addClass(d),k.after(a),k=a}function b(a,b,c){var d=$("<tr class='"+b+"'/>"),e=$("<td class='remove-link'/>");e.append(c);d.append(e);d.append("<td><span>"+a.browseNodeName+"</span></td>");d.append("<td><span>"+a.browseId+"</span></td>");q(b,a.productTypeDefinitions)||(x[b]="true");c="";x[b]&&(u||(u="Category ineligible for Custom Template"),c='<div class="a-box a-alert-inline a-alert-inline-warning right"><div class="a-box-inner a-alert-container"><i class="a-icon a-icon-alert"></i><div class="a-alert-content">'+
u+"</div></div></div>");d.append("<td><span>"+a.displayableBrowsePathByName+"</span></td><td>"+c+"</td>");m.find("#header").after(d)}function f(a){$.each(a,function(a,b){H[b.id]=b})}function J(){e.post("#",{params:{},timeout:3E4,success:function(a){c.checkRedirect(a)||f(a)},error:function(){w++;5>w?J():(a.hidePleaseWait(),w=0)}})}function k(){var b={expanderState:$("#custom-template-holder").children("div").children("div").children("div").attr("aria-expanded")};
e.post("#",{params:b,timeout:3E4,success:function(b){c.checkRedirect(b)||($("#custom-template-holder").html(b),a.hidePleaseWait())},error:function(){a.hidePleaseWait()}})}function v(a){var c="ID-"+a.browsePathById.join("-");if(!l[c]){var e=null,e=0===n%2?"grey-row":"white-row",f=$("<span class='a-icon delete-icon'></span>");f.click(function(){$("#"+c+"-template-link").val();m.find("."+c).remove();delete l[c];x[c]&&delete x[c];D();n--;0===n&&t.hide();p()});
"true"===$("#isITKPresent").val()?d(a,c,f,e):b(a,c,f);l[c]=a;D();0===n&&t.show();n++;p()}}function g(b){e.post("/listing/customtemplates/documentbyid",{params:{id:b,withBrowseInfo:"true"},timeout:3E4,success:function(a){c.checkRedirect(a)||(f(a),$.each(a,function(a,b){$.each(b.browseNodes,function(a,b){v(b)});h.when("mode-picker").execute(function(a){a.selectMode(b.templateType)})}))},error:function(){w++;5>w?J():(a.hidePleaseWait(),w=0)}})}function D(){var a={};$.each(l,function(b,c){if(c.productTypeDefinitions){var d=
c.productTypeDefinitions[0];a[d]=d}});10<Object.keys(a).length?$("#ptd-limit-warning").show():$("#ptd-limit-warning").hide()}function p(){0<Object.keys(x).length?$("#custom-template-button").addClass("a-button-disabled"):$("#custom-template-button").removeClass("a-button-disabled")}function q(a,b){var c=!1;$.each(b,function(a,b){0<jQuery.inArray(b,$(B))&&(c=!0)});return c}var l={},n=0,B=null,m=null,t=null,u=null,H={},w=0,x={};return{init:function(){m=$("#classifications-table");t=$("#classification-table-container");
B=e.parseJSON($("#productTypes").val());u=$("#ineligibleStringVal").val()},addRow:function(a){v(a)},populateRecentDocumentsCache:function(){J()},redrawRecentDocuments:function(){k()},addTemplateToTable:function(a){var b=H[a];b===r?g(a):($.each(b.browseNodes,function(a,b){v(b)}),h.when("mode-picker").execute(function(a){a.selectMode(b.templateType)}))},emptyTable:function(){l={};x={};n=0;m.find("#header").nextAll().remove();t.hide();p();$("#warning-msg").hide()},dumpTableData:function(){var a={},b=
[];$.each(l,function(a,c){b.push(c)});a["selected-nodes"]=JSON.stringify(b);a["num-of-nodes"]=n;return a}}});h.when("ready").register("debug-script-evaluator",function(){return{execResponseScript:function(e){e=$(e).filter(".debug-info");0<e.length&&$.globalEval(e[0].innerHTML)}}});h.when("A").register("download-handler",function(e){var a=/[<>&\r\n"']/gm,c={"<":"lt;",">":"gt;","&":"amp;","\r":"#13;","\n":"#10;",'"':"quot;","'":"#39;"};return{fileDownload:function(d,b){function e(a){a=
a[0].contentWindow||a[0].contentDocument;a.document&&(a=a.document);return a}function J(){if(-1!==document.cookie.indexOf(g.cookieName+"="+g.cookieValue)){r.onSuccess(d);var a=g.cookieName+"=; path="+g.cookiePath+"; expires="+(new Date(0)).toUTCString()+";";g.cookieDomain&&(a+=" domain="+g.cookieDomain+";");document.cookie=a;k(!1)}else{if(u||t)try{var b=u?u.document:e(t);if(b&&null!==b.body&&b.body.innerHTML.length){a=!0;if(H&&H.length){var c=$(b.body).contents().first();try{c.length&&c[0]===H[0]&&
(a=!1)}catch(l){if(l&&-2146828218===l.number)a=!0;else throw l;}}if(a){setTimeout(function(){r.onFail(b.body.innerHTML,d);k(!0)},100);return}}}catch(n){r.onFail("",d);k(!0);return}setTimeout(J,g.checkInterval)}}function k(a){setTimeout(function(){u&&(l&&u.close(),q&&u.focus&&(u.focus(),a&&u.close()))},0)}function h(b){return b.replace(a,function(a){return"&"+c[a]})}var g=$.extend({preparingMessageHtml:null,failMessageHtml:null,androidPostUnsupportedMessageHtml:"Unfortunately your Android browser doesn't support this type of file download. Please try again with a different browser.",
dialogOptions:{modal:!0},prepareCallback:function(a){},successCallback:function(a){},failCallback:function(a,b){},httpMethod:"GET",data:null,checkInterval:100,cookieName:"fileDownload",cookieValue:"true",cookiePath:"/",cookieDomain:null,popupWindowTitle:"Initiating file download...",encodeHTMLEntities:!0},b),D=new $.Deferred,p=(navigator.userAgent||navigator.vendor||m.opera).toLowerCase(),q,l,n;/ip(ad|hone|od)/.test(p)?q=!0:-1!==p.indexOf("android")?l=!0:n=/avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|playbook|silk|iemobile|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(p)||
/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(p.substr(0,
4));p=g.httpMethod.toUpperCase();if(l&&"GET"!==p&&g.androidPostUnsupportedMessageHtml)return $().dialog?$("<div>").html(g.androidPostUnsupportedMessageHtml).dialog(g.dialogOptions):alert(g.androidPostUnsupportedMessageHtml),D.reject();var B=null,r={onPrepare:function(a){g.preparingMessageHtml?B=$("<div>").html(g.preparingMessageHtml).dialog(g.dialogOptions):g.prepareCallback&&g.prepareCallback(a)},onSuccess:function(a){B&&B.dialog("close");g.successCallback(a);D.resolve(a)},onFail:function(a,b){B&&
B.dialog("close");g.failMessageHtml&&$("<div>").html(g.failMessageHtml).dialog(g.dialogOptions);g.failCallback(a,b);D.reject(a,b)}};r.onPrepare(d);null!==g.data&&"string"!==typeof g.data&&(g.data=$.param(g.data));var t,u,H;if("GET"===p)null!==g.data&&(-1!==d.indexOf("?")?"&"!==d.substring(d.length-1)&&(d+="&"):d+="?",d+=g.data),q||l?(u=m.open(d),u.document.title=g.popupWindowTitle,m.focus()):n?m.location(d):t=$("<iframe>").hide().prop("src",d).appendTo("body");else{var w="";null!==g.data&&$.each(g.data.replace(/\+/g,
" ").split("&"),function(){var a=this.split("="),b=g.encodeHTMLEntities?h(decodeURIComponent(a[0])):decodeURIComponent(a[0]);b&&(a=g.encodeHTMLEntities?h(decodeURIComponent(a[1])):decodeURIComponent(a[1]),w+='<input type="hidden" name="'+b+'" value="'+a+'" />')});n?(H=$("<form>").appendTo("body"),H.hide().prop("method",g.httpMethod).prop("action",d).html(w)):(q?(u=m.open("about:blank"),u.document.title=g.popupWindowTitle,n=u.document,m.focus()):(t=$("<iframe style='display: none' src='about:blank'></iframe>").appendTo("body"),
n=e(t)),n.write("<html><head></head><body><form method='"+g.httpMethod+"' action='"+d+"'>"+w+"</form>"+g.popupWindowTitle+"</body></html>"),H=$(n).find("form"));H.submit()}setTimeout(J,g.checkInterval);n=D.promise();n.abort=function(){k();t.remove()};return n}}});h.when("A").execute(function(e){e.declarative("show-classifier","click",function(a){m.location="/hz/inventory/classify"})});h.when("A","ajax-redirect-handler","ready").register("gating-util",function(e,a){var c=
{},d=!1;return{init:function(){var a=jQuery("#approvedGLProductGroups").val();if(a&&""!==a){a=jQuery.parseJSON(a);d=!0;for(var e=0;e<a.length;e++)c[a[e]]=!0}},glIsApproved:function(a){return!0===c[a]},isActive:function(){return d},renderLockingOnJQueryCollection:function(a,d,h){a.each(function(a,b){var g=e.parseJSON($(b).find(".glProductGroups")[0].value),D=!1;for(a=0;a<g.length;a++)if(!0===c[g[a]]){D=!0;break}0===g.length&&(D=!0);D?h(b):d(b)})},requestApproval:function(b){e.post("/listing/productclassifier/requestapproval",
{params:{glProductGroups:b.data.toString()},timeout:3E3,success:function(b){a.checkRedirect(b)||m.open(b)}})}}});h.when("A","form","ready").execute(function(e,a){e.declarative("show-reportvariant-pref","change",function(a){var d=e.$("#reportVariantClick").find("select.a-native-dropdown").val();a=e.$("#report_descriptions").find("div");e.each(a,function(a,b){a.className=a.id===d+"_DESC"?"":"hidden"});var b=e.$("#"+d+"_secondary").val();a=e.$("[id$=_label]");var f=e.$("#extraInputs");f.removeClass("a-spacing-small");
e.each(a,function(a,c){a.id===b+"_label"?(a.className="",f.addClass("a-spacing-small")):a.className="hidden"});a=e.$("[id$=_input]");e.each(a,function(a,c){a.className=a.id===b+"_input"?"":"hidden"})});e.$("#reports-table").find("div.mt-header").remove();e.$("#reports-table").find("div.mt-foot").remove();e.$("#reportVariantClick").trigger("change")});h.when("A").execute(function(e){e.on("a:dropdown:selected:reportCountDropDown",function(a){$(location).attr("href","/listing/reports?report_count="+
a.value)})});h.when("A","tabela-manager","ready").execute(function(e,a){function c(){$("#reports-table td[id$='-requested'], #reports-table td[id$='-completed']").each(function(a,b){var c=Number($(b).text());isNaN(c)||(c=new Date(c),$(b).html(c.toLocaleDateString()+" "+c.toTimeString()))})}setInterval(function(){document.getElementById("reports-table")&&(console.log("refreshing reports table"),a.get("reports-table").refreshTable(),console.log("refreshed reports table"))},3E4);e.on("tabela:table-refresh-done",
function(a){c()});c()});h.when("mode-picker-ui","jQuery").register("mode-picker",function(e){function a(){h.when("client-logger").execute(function(a){a.logCount("CLIENT_CUTE_MODE_PICKER_INTERACTION")})}var c=$(e).find("#mode-picker-button-group input"),d=$(e).find("#mode-picker-custom-dropdown-container");return{init:function(){c.each(function(){$(this).click(function(b){var c=$(b.target);b.originalEvent&&0===c.parents(".a-button-selected").length&&a();d.length&&(0<c.closest("#mode-picker-custom-button").size()?
d.show():d.hide())})})},selectMode:function(a){a&&"none"!==a?c.filter("[value='"+a+"']").click():c.filter("[value='advanced']").click()}}});h.when("A","classification-table-handler","please-wait-msg-handler","ajax-redirect-handler").register("search-handler",function(e,a,c,d){function b(a,b){c.hidePleaseWait();u.empty();u.append(b);t=e.parseJSON($("#searchResults").val());w.hide();u.show();H.hide();null!==t&&(q={},n=[],B=!1,0>=t.length||($.each(t,function(a,b){n.push(b.browsePathById.join("/"))}),
v(5,!1),f()))}function f(){var a=$(".search-results-table tr");null!==l&&l.isActive()?l.renderLockingOnJQueryCollection(a,h,k):a.each(function(a,b){k(b)})}function h(a){$(a).find(".locked-search").show();$(a).find(".add-link").hide()}function k(a){$(a).find(".locked-search").hide();$(a).find(".add-link").show()}function v(a,b){if(!0!==B){var f=a;n.length<a&&(f=n.length);f=n.splice(0,f);B=!0;f={"nodes-to-fetch":JSON.stringify(f)};e.post("/listing/productclassifier/fetchrefinements",{params:f,timeout:3E4,
success:function(a){d.checkRedirect(a)||(B=!1,g(a))},error:function(){B=!1;x++;5>x?v(5,!1):(c.hidePleaseWait(),x=0)}})}}function g(a){$.each(a,function(a,b){q[b.browsePathById.join("/")]=b});0<n.length?v(5,!1):m&&D()}function D(){for(var a=t.length-1;0<=a;a--){var b;a:if(b=t[a].glProductGroups,null===l||0===b.length)b=!0;else{for(var d=0;d<b.length;d++)if(l.glIsApproved(b[d])){b=!0;break a}b=!1}b&&p(t[a].browsePathById.join("/"))}c.hidePleaseWait()}function p(b){a.init();a.addRow(q[b])}var q={},l=
null,n=[],B=!1,m=!1,t=null,u=null,H=null,w=null,x=0;return{init:function(){u=$("#search-results-container");H=$("#browse-container");w=$("#search-timeout")},setGatingUtil:function(a){l=a},requestSearchData:function(a){c.showPleaseWait();e.post("/listing/productclassifier/search",{params:{query:a},timeout:3E4,success:function(c){d.checkRedirect(c)||b(a,c)},error:function(){c.hidePleaseWait();w.show();u.hide();H.hide()}})},addAllSearchResultsToTable:function(){c.showPleaseWait();m=!0;n=[];for(var a=
t,b=a.length-1;0<=b;b--)r===q[a[b].browsePathById.join("/")]&&n.push(a[b].browsePathById.join("/"));0===n.length&&D()},addNodeToTable:function(a){if(r!==q[a])p(a);else{var b=[];b.push(a);c.showPleaseWait();b={"nodes-to-fetch":JSON.stringify(b)};e.post("/listing/productclassifier/fetchrefinements",{params:b,timeout:3E4,success:function(b){d.checkRedirect(b)||(c.hidePleaseWait(),q[a]=b[0],p(a))},error:function(){c.hidePleaseWait()}})}}}});h.when("A").execute(function(e){e.on("a:dropdown:selected:feedCountDropDown",
function(a){$(location).attr("href","/listing/status?feed_count="+a.value)})});h.when("A","tabela-manager","add-completed-drafts-info","ready").execute(function(e,a,c){setInterval(function(){document.getElementById("status-table")&&a.get("status-table").refreshTable()},3E4);document.getElementById("status-table")&&c.addInfoIcon();e.on("tabela:table-refresh-done",function(a){document.getElementById("status-table")&&c.addInfoIcon()})});h.when("A","a-popover","ready").register("add-completed-drafts-info",
function(e,a){return{addInfoIcon:function(){$("div[id$='fyi_link']").each(function(c,d){var b=$($(d).children()[0]),e=$("<span>");e.addClass("mini-info-icon");b.append(e);b={};b.inlineContent=$("#completeDraftsMessage").val();b.position="triggerTop";a.create(e,b)});$("td[id$='-status']").each(function(a,d){var b=$(d).find(".mt-message-text");$(b).length&&b.addClass("record_processed_message")})}}});h.when("A","form","ready").execute(function(e,a){e.declarative("show-feedvariant-pref",
"change",function(c){var d=c.data.formType;c=c.$target.val();$("#"+d+"-NOTE").show();$("#"+d+"-selected-variant").val(c);var b=$("#"+d+"-form").find('input[name="feed"]').val().split("."),e=b[b.length-1],h=!1;if(b=$("#"+d+"-"+c+"-file-types-not-allowed").val())b=b.substring(1,b.length-1).split(","),$(b).each(function(a,b){$.trim(b).toLowerCase()===e&&(h=!0);"XLS"!==$.trim(b)&&"XLSX"!==$.trim(b)||$("#"+d+"-NOTE").hide()});h?$("#"+d+"-feedformat-error").show():$("#"+d+"-feedformat-error").hide();a.validateFeedVariant(d);
$("#"+d+"-feedvariant-pref").empty();$("#"+d+"-feedvariant-pref").html($("#"+d+"-"+c+"-pref").html());$("#"+d+"-feedvariant-report-pref").empty();$("#"+d+"-feedvariant-report-pref").html($("#"+d+"-"+c+"-report-pref").html())})});h.when("A","form","ready").execute(function(e,a){e.declarative("toggle-feed-error","change",function(c){a.validateFeed(c.data.formType)})});h.when("A","form","ready").execute(function(e,a){e.declarative("toggle-email-error","change",function(c){c=c.data.formType;var d=a.validateEmail(c),
b=$("#"+c+"-form").find('input[name="email"]').val();0!==b.length&&d?($("#"+c+"-email-box").hide(),$("#"+c+"-email-text span").text(b),$("#"+c+"-email-text").show(),$("#"+c+"-email-change-link").show(),$("#"+c+"-email-alert-ckeckbox").attr("checked",!0),$("#"+c+"-email-alert-ckeckbox").css("visibility","visible")):($("#"+c+"-email-alert-ckeckbox").css("visibility","hidden"),$("#"+c+"-email-alert-ckeckbox").attr("checked",!1));d&&(a.updateEmailRUP(b),a.updateCheckboxRUP(c))})});h.when("A","form","ready").execute(function(e,
a){e.declarative("change-email","click",function(a){a=a.data.formType;$("#"+a+"-email-text").hide();$("#"+a+"-email-change-link").hide();$("#"+a+"-email-box").show()});e.declarative("toggle-email-alert-checkbox","change",function(c){a.updateCheckboxRUP(c.data.formType)})});h.when("A").execute(function(e){e.declarative("handle-shipping-plus","change",function(a){a=a.$target.attr("id");if("option-Y"===a||"option-PLUS"===a){var c=$("#"+a).closest("div.shipping-table-section");a="option-Y"===a;var d=
c.find("#option-Y"),b=c.find("#option-DOMESTIC"),c=c.find("#option-PLUS"),d=d.is(":checked"),e=b.is(":checked"),h=c.is(":checked");d||h?(a?d&&e&&c.attr("checked","checked"):h?b.attr("checked","checked"):b.removeAttr("checked"),b.attr("disabled","disabled")):b.removeAttr("disabled")}})});h.when("A").execute(function(e){if(document.getElementById("recExcelMessage-purgereplace")){e=$("#recExcelMessage-purgereplace");var a=$("#reportFormat-purgereplace");e&&a&&a.attr("checked")?e.show():e&&e.hide()}document.getElementById("recExcelMessage-upload")&&
(e=$("#recExcelMessage-upload"),a=$("#reportFormat-upload"),e&&a&&a.attr("checked")?e.show():e&&e.hide())});h.when("A","form","ready").execute(function(e,a){e.declarative("rec-excel-message","change",function(a){var d=$("#recExcelMessage-"+a.data.formType);"text"===a.$target.attr("value")?d.hide():d.show()})});h.when("A","debug-script-evaluator").register("form",function(e,a){return{validate:function(a){var d=this.validateFeedVariant(a),b=this.validateFeed(a);a=this.validateEmail(a);return d&&b&&
a},validateFeedVariant:function(a){var d=!0;$("#"+a+"-form").find('select[name="feedVariant"]').val()?$("#"+a+"-feedvariant-error").hide():($("#"+a+"-feedvariant-error").show(),d=!1);return d},validateFeed:function(a){var d=!0,b=$("#"+a+"-form").find('input[name="feed"]').val(),e=b.split("."),h=e[e.length-1],k=!1,e=$("#"+a+"-selected-variant").val();if(e=$("#"+a+"-"+e+"-file-types-not-allowed").val())e=e.substring(1,e.length-1).split(","),$(e).each(function(a,b){$.trim(b).toLowerCase()===h&&(k=!0)});
b?$("#"+a+"-feed-error").hide():($("#"+a+"-feed-error").show(),d=!1);k?($("#"+a+"-feedformat-error").show(),d=!1):$("#"+a+"-feedformat-error").hide();return d},validateEmail:function(a){var d=!1,b=$("#"+a+"-form").find('input[name="email"]').val();if(200>=b.length){var e=/^[a-zA-Z0-9!#$%&'*+\/=?\^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+\/=?\^_`{|}~-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$/;0===b.length||e.test(b)?($("#"+a+"-email-error").hide(),d=!0):$("#"+
a+"-email-error").show()}return d},submit:function(a){$("#"+a+"-form").submit()},updateEmailRUP:function(a){$.ajax({type:"GET",url:"/listing/rup/email?email="+a})},updateCheckboxRUP:function(c){var d=$("#"+c+"-email-alert-ckeckbox").is(":checked");$.ajax({type:"GET",url:"/listing/rup/checkbox?formtype="+c+"&checked="+d}).done(function(b){a.execResponseScript(b)})}}});h.when("A","ready").execute(function(e){e.on("a:expander:check_my_file_expander:toggle:expand",function(a){$.ajax({type:"GET",url:"/listing/rup/cmf?collapse=true"})});
e.on("a:expander:check_my_file_expander:toggle:collapse",function(a){$.ajax({type:"GET",url:"/listing/rup/cmf?collapse=false"})})});h.when("A","a-modal","form","ready").execute(function(e,a,c){e.declarative("form-submit","click",function(d){d.$event.preventDefault();var b=d.data.formType;"true"===d.data.enabled&&c.validate(b)&&("true"===d.data.showConfirmBox?a.get($("#"+b+"-form-submit-modal")).show():c.submit(b))});e.declarative("form-submit-ok","click",function(d){d.$event.preventDefault();d=d.data.formType;
a.get($("#"+d+"-form-submit-modal")).hide();c.submit(d)});e.declarative("form-submit-cancel","click",function(c){c.$event.preventDefault();a.get($("#"+c.data.formType+"-form-submit-modal")).hide()})});h.when("jQuery").register("sanitize-util",function(e){return{stripTags:function(a){var c=e("<div>");c[0].innerHTML=a;return c.text()},escapeHtml:function(a){var c=document.createElement("div");c.appendChild(document.createTextNode(a));return c.innerHTML}}});h.when("A","varwiz-constants",
"row-control-btn-state-factory","ready").register("variation-row-control-util",function(e,a,c){function d(){function b(){l.deleteRow()}function d(){l.editRow()}function e(){l.saveEdit()}function b(){l.deleteRow()}function k(){l.cancelEdit()}function h(){l.undoDelete()}function g(){l.sellYours()}function D(){var a=F.getState();p(A);switch(a){case K:q(w);break;case O:q(x);break;case G:q(I);break;case Q:q(z);break;case R:q(E)}}function p(a){$.each(a,function(a,b){$(b).hide()})}function q(a){$.each(a,
function(a,b){$(b).css("display","inline-block")})}var l,n,B,r,t,u,m,w,x,I,z,E,A,F,T=a.selectors.EDIT_BTN_CLASS,M=a.selectors.DELETE_BTN_CLASS,N=a.selectors.UNDO_DELETE_BTN_CLASS,y=a.selectors.SAVE_EDIT_BTN_CLASS,C=a.selectors.CANCEL_EDIT_BTN_CLASS,L=a.selectors.SELL_YOURS_BTN_CLASS,K=a.VariationRowControls_BtnStates.SAVE_CANCEL,O=a.VariationRowControls_BtnStates.EDIT_DELETE,Q=a.VariationRowControls_BtnStates.EDIT,G=a.VariationRowControls_BtnStates.UNDO_DELETE,R=a.VariationRowControls_BtnStates.SELL_YOURS,
da=a.VariationRow_State.ADDED,ea=a.VariationRow_State.FOREIGN,Z=a.VariationRow_ParentageEnum.PARENT;return{init:function(a){l=a;a=l.getParentage();var p=l.getState();F=c.createBtnState(a===Z?Q:p===ea?R:p===da?K:Q);a=l.getRowElemObj();n=a.find(T);B=a.find(M);u=a.find(N);r=a.find(y);t=a.find(C);m=a.find(L);w=[r,t];x=[n,B];z=[n];I=[u];E=[m];A=[r,t,n,B,u,m];n.click(d);B.click(b);u.click(h);r.click(e);t.click(k);m.click(g);D()},transitionBtnState:function(a){var b=l.getParentage(),c=l.getState();F.transitionState(a,
c,b);D()}}}console.log("Variation Row Control Factory Registered.");return{initControlsForRow:function(a){var c=new d;c.init(a);return c}}});h.when("A","variation-row-control-util","varwiz-constants","row-state-factory","a-popover","sku-generator","cell-validator-factory","itk-component","price-formatter","ready").register("row-factory",function(e,a,c,d,b,f,h,k,v){function g(b){function e(){switch(O.getState()){case ha:C.remove();y.removeRow(X);break;case ta:w();m(ba);break;default:C.addClass(Z),
m(ba)}y.notifyValidRow(X)}function g(){return K===ya}function n(a){I(fa).html(a)}function B(){var a=I(ca),b=a.find("input"),c=0<b.length,d=c?b.val():a.text(),d=v.formatPriceStr(d,ia);c?b.val(d):a.text(d)}function D(a,b){var c=C.find("th#"+a);if(0<c.length){var d=c.text(),e=$("<div>");e.addClass(za);e.addClass(b);c.html(d+e[0].outerHTML)}}function t(){var a=O.getState()===ja;return g()&&a}function u(){var a=y.getParentRow(),b="";a!==r&&null!==a&&(b=a.getSKU());return b}function m(a){R.transitionBtnState(a);
O.transitionRowState(a)}function w(){var a=$(ua).find("td"),b=C.find("td");$.each(a,function(a,c){if(!$(c).hasClass(ka)){var d=b[a],e=$(c).html();$(d).html(e)}})}function x(){var a=!0;$.each(G,function(b,c){var d=va.validateCell(c);a=a&&d});return a}function I(a){return C.find("td["+W+"='"+a+"']")}function z(){Q=[];$.each(C.find("td"),function(a,b){Q.push(b);var c=$(b).text().trim();$(b).hasClass(ka)||$(b).html(c);$(b).attr(W)===ca&&N(b)})}function E(a){G=[];$.each(a,function(a,b){var c=$(b).attr(W);
y.isColumnEditable(c)&&G.push(b)})}function A(a){$.each(C.find("th"),function(a,b){var c=$(b).attr("id");y.isColumnHidden(c)&&$(b).hide()});$.each(a,function(a,b){var c=$(b).attr(W);y.isColumnHidden(c)&&$(b).hide()})}function F(){$.each(G,function(a,b){var c=$(b).attr(W);if(c===fa&&O.getState()===oa)return!0;var d=y.getEnums()[c];$(b).width();var e=$(b).text().trim();e===r&&(e="");if(d){var f=$("<select>");$.each(d,function(a,b){var c=$("<option>");e.toUpperCase()===b.toUpperCase()&&c.attr("selected",
"selected");c.attr(wa,b);c.html(b);f.append(c)});d=f}else d=$("<input>"),d.attr("type","text"),d.attr(wa,e),d.addClass(Aa);d.attr("initial-value",e);$(b).html(d);c===ca&&$(b).attr(pa,la)})}function T(){$.each(G,function(a,b){var c=$(b).find("input, select");0<c.size()&&$(b).text(c.val());$(b).attr(W)===ca&&N(b)})}function M(){$.each(G,function(a,b){var c=$(b).find("input.editFld, select");0<c.size()&&$(b).text(c.attr("initial-value"));$(b).attr(W)===ca&&N(b)})}function N(a){""!==$(a).text().trim()?
$(a).attr(pa,la):$(a).removeAttr(pa)}b!==r&&null!==b||console.log("ERROR: attempted to create row with null or undefined variation table.");var y=b,C,L,K,O,Q,G,R=null,da=c.SELL_YOURS_ROW_CLASS,ea=c.ADDED_ROW_CLASS,Z=c.DELETED_ROW_CLASS,V=c.HEAD_ROW_CLASS,P=c.VariationRow_RowTypeEnum.HEADER,aa=c.VariationRow_RowTypeEnum.NORMAL,Y=c.VariationRowOperations.EDIT,ba=c.VariationRowOperations.DELETE,U=c.VariationRowOperations.SAVE,ga=c.VariationRowOperations.CANCEL,ma=c.VariationRowOperations.UNDO_DELETE,
Ba=c.VariationRowOperations.SELL_YOURS,ka=c.ROW_CONTROLS_CLASS,Aa=c.EDIT_FIELD_CLASS,Ca=c.selectors.ROW_CONTROL_SELECTOR_ID,ha=c.VariationRow_State.ADDED,oa=c.VariationRow_State.UPDATED,ja=c.VariationRow_State.FOREIGN,ta=c.VariationRow_State.ADOPTED,fa=c.StaticColumnKeys.SKU,Da=c.StaticColumnKeys.EXTERNAL_PRODUCT_ID_TYPE,Ea=c.StaticColumnKeys.PARENTAGE,Fa=c.StaticColumnKeys.ASIN,Ga=c.StaticColumnKeys.QUANTITY,za=c.INFO_ICON_CLASS,Ha=c.infoPopoverClasses.SKU,Ia=c.infoPopoverClasses.EXTERNAL_PRODUCT_ID_TYPE,
Ja=c.RELATIONSHIP_TYPE_KEY,Ka=c.VARIATION_RELATIONSHIP,La=c.PARENT_SKU_KEY,Ma=c.STANDARD_PRICE_KEY,ca=c.LIST_PRICE_KEY,Na=c.ITK_KEY,Oa=c.RBN_KEY,qa=c.TemplateOperationValues.UPDATE,xa=c.TemplateOperationValues.PARTIAL_UPDATE,Pa=c.TEMPLATE_OPERATION_KEY,na={};na[ha]=qa;na[oa]=xa;na[ta]=qa;var W=c.CELL_COLUMN_ATTR,ya=c.VariationRow_ParentageEnum.PARENT,Qa=c.PARENT_ROW_CLASS,wa=c.VALUE_ATTR,ra=!1,ua,sa=null,Ra=c.SHADOW_PARENT_SKU_PREFIX,va,pa=c.CURRENCY_SYMBOL_ATTR;b=c.selectors.DECIMAL_DELIMITER_ID;
var la=$(c.selectors.CURRENCY_SYMBOL_ID).text();""===la.trim()&&(la="$");var ia=$(b).text();""===ia.trim()&&(ia=".");var X={init:function(b){C=b;L=C.hasClass(V)?P:aa;b=I(Ea);b!==r?K=b.text().trim():console.log("Couldn't determine parentage, because couldn't locate parentage cell.");z();E(Q);A(Q);b=C.hasClass(da)?ja:C.hasClass(ea)?ha:oa;O=d.createRowState(b);if(!(0<C.find("td.rowControls, th.controlHeader").size())){var c;if(L!==P){c=$(Ca).html();var e=$("<td>");e.addClass(ka);g()||e.append(c);c=e[0].outerHTML}C.append(c)}L===
P||g()||(R=a.initControlsForRow(X));va=h.createCellValidator(y.getConstraints(),ia);b===ja&&(ua=C[0].outerHTML);g()&&(C.addClass(Qa),I(Ga).html(""));t()&&(sa=f.generateSKU(Ra));L===P&&(D(fa,Ha),D(Da,Ia));g()||B()},editRow:function(){y.beginEdit();F();m(Y)},deleteRow:e,saveEdit:function(){B();x()?(T(),y.completeEdit(),m(U),ra=!0,y.notifyValidRow(X)):y.notifyInvalidRow(X)},cancelEdit:function(){M();y.completeEdit();m(ga);y.notifyValidRow(X);O.getState()!==ha||ra||e();O.getState()!==ja||ra||n("")},undoDelete:function(){C.removeClass(Z);
m(ma)},sellYours:function(){y.beginEdit();var a=u(),a=f.generateSKU(a);n(a);F();m(Ba)},getParentage:function(){return K},isParent:g,getRowElemObj:function(){return C},getState:function(){return O.getState()},clearEditableValues:function(){$.each(G,function(a,b){$(b).html("")})},getType:function(){return L},toJSON:function(){var a={};$.each(Q,function(b,c){var d=$(c).attr(W),e=$(c).text().trim();$(c).hasClass(ka)||(a[d]=e)});var b=xa,c=O.getState();null!==c&&c!==r&&(c=na[c],c!==r&&(b=c));t()&&(b=qa);
a[Pa]=b;a[Ma]=a[ca];k.isITKSupported()&&(b=k.getSelectedITK(),isNaN(b)?a[Na]=k.getSelectedITK():a[Oa]=k.getSelectedITK());t()&&(a[fa]=sa);g()||(a[Ja]=Ka,b=u(),a[La]=b);return a},getSKU:function(){return t()?sa:I(fa).text().trim()},setSKU:n,setASIN:function(a){I(Fa).html(a)}};return X}function D(a){return{getRowFromRowElemObj:function(b){if(null===a||a===r)console.log("ERROR: Variation Table not initialized yet. Call initRowFactory first.");else{var c=new g(a);c.init(b);return c}}}}console.log("Variation Row Factory Registered.");
return{createRowFactoryInstance:function(a){return new D(a)}}});h.when("A","varwiz-constants","row-factory","ui-message-util","sku-generator","ready").register("variation-table-factory",function(e,a,c,d,b){function f(){function e(){for(var a=0;a<t.length;a++){var b=t[a];if(b.isParent())return b}console.log("Error: no parent row found in table.")}function f(a,b){if(null===a||a===r)console.log("ERROR: Attempted to remove a null or undefined obj from array.");else if(null===b||b===r)console.log("ERROR: Attempted to remove an object from null or undefined array.");
else{var c=b.indexOf(a);-1!==c&&b.splice(c,1)}}function h(){d.clearAll();0<K.length&&d.addMessage(y,L)}function g(){u=0;B=[];t=[];H={};w={}}function m(b){$.each(B,function(c,d){$.each(a.constraints,function(c,e){var f=b.find("#"+e+"_"+d).attr(a.VALUE_ATTR);f&&(H[d]||(H[d]={}),H[d][e]=f)});var e=!1;for(c=0;!e;c++){var f=b.find("#enum"+c+"_"+d).attr(a.VALUE_ATTR);f?(w[d]||(w[d]={}),w[d][c]=f):e=!0}})}function p(b){b=b||n.find("tr");1===b.length?(n.addClass(M),l.find(a.selectors.ADD_ROW_BTN_ID).addClass(M),
l.find(a.selectors.GENERATE_TEMPLATE_BTN_ID).addClass(M)):(n.removeClass(M),l.find(a.selectors.ADD_ROW_BTN_ID).removeClass(M),l.find(a.selectors.GENERATE_TEMPLATE_BTN_ID).removeClass(M),$.each(b,function(a,b){var c=$(b),c=q.getRowFromRowElemObj(c);t.push(c)}))}var q,l,n,B=[],S=[],t=[],u=0,H={},w={},x=[],I=0,z=a.VariationRow_State.FOREIGN,E=a.VariationRow_RowTypeEnum.HEADER,A=a.ADDED_ROW_CLASS,F=a.SELL_YOURS_ROW_CLASS,T=a.DELETED_ROW_CLASS,M=a.selectors.HIDDEN_CLASS,N=a.selectors.NO_VARIATIONS_LOADED_ROW,
y=a.UIMessageTypes.ERROR,C=!1,L=$("#table-constraint-violation-error-msg"),K=[],O={init:function(b){g();l=b;n=l.find(a.selectors.VARIATION_TABLE_ID);q=c.createRowFactoryInstance(O);p()},isColumnEditable:function(a){return-1!==B.indexOf(a)},isColumnHidden:function(a){return-1!==S.indexOf(a)},renderFromSearchResponse:function(b,c){var e=$(b),f=e.find(a.selectors.VARIATION_TABLE_ID),k=[];x[c]=[];if(0===c){if(0<e.find(N).length){C=!1;k=$("#no-variation-family-found-error-message");d.containerIsEmpty(y)&&
d.addMessage(y,k);return}g();var k=e.find(a.selectors.EDITABLE_COLUMNS_ID),h=e.find(a.selectors.HIDDEN_COLUMNS_ID);B=k.attr(a.VALUE_ATTR).replace(/[\[\] ]/g,"").split(",");m(e);S=h.attr(a.VALUE_ATTR).replace(/[\[\] ]/g,"").split(",");k=f.html();n.html(k);k=n.find("tr");for(e=1;e<k.length;e++)f=k[e],x[c].push(f);C=!0}else for(k=f.find("tr"),h=n.find("table tbody"),e=1;e<k.length;e++)f=k[e],$(f).hide(),h.append(f),x[c].push(f);p(k)},changePage:function(a){x.forEach(function(b,c){c===a?$.each(b,function(a,
b){$(b).show()}):$.each(b,function(a,b){$(b).hide()})});I=a},beginEdit:function(){u++;l.notifyUpdatedEditCount(u)},completeEdit:function(){u--;l.notifyUpdatedEditCount(u)},getTableRows:function(){return t},addRow:function(){if(2>t.length)console.log("Can only add rows to tables with at least 1 child row.");else{var a=x[I],a=$(a[a.length-1]).clone();a.removeClass(F);a.removeClass(T);a.addClass(A);var c=q.getRowFromRowElemObj(a),d=e(),f="";d!==r&&null!==d&&(f=d.getSKU());d=b.generateSKU(f);n.find("table tbody").append(a);
x[I].push(a);c.clearEditableValues();c.setSKU(d);c.setASIN("");c.editRow();t.push(c)}},removeRow:function(a){f(a,t)},getConstraints:function(){return H},getEnums:function(){return w},toJSON:function(){var a=[];$.each(t,function(b,c){var d=c.getType()===E,e=c.getState()===z,f=c.isParent();d||e&&!f||a.push(c.toJSON())});return a},hasSuccessfullyLoaded:function(){return C},notifyInvalidRow:function(a){-1===K.indexOf(a)&&K.push(a);h()},notifyValidRow:function(a){f(a,K);h()},getParentRow:e};return O}return{createTable:function(a){var b=
new f;b.init(a);return b}}});h.when("ready").register("varwiz-constants",function(){console.log("VarwizConstants instantiated.");return{selectors:{VARIATION_TABLE_ID:"#variation-table",EDITABLE_COLUMNS_ID:"#editableColumnTitles",HIDDEN_COLUMNS_ID:"#hiddenColumnTitles",CURRENCY_SYMBOL_ID:"#currency-symbol",DECIMAL_DELIMITER_ID:"#decimal-delimiter",ROW_CONTROL_SELECTOR_ID:"#rowControls",ADD_ROW_BTN_ID:"#add-row-btn",GENERATE_TEMPLATE_BTN_ID:"#generate-template-btn",EDIT_BTN_CLASS:".edit-btn",
SAVE_EDIT_BTN_CLASS:".save-btn",CANCEL_EDIT_BTN_CLASS:".cancel-btn",DELETE_BTN_CLASS:".delete-btn",UNDO_DELETE_BTN_CLASS:".undo-delete-btn",SELL_YOURS_BTN_CLASS:".addyours-btn",HIDDEN_CLASS:"a-hidden",UI_MESSAGE_CONTAINER:".ui-msg-container",UI_MESSAGE_ERROR_BOX:".varwiz-ui-error-msgs",UI_MESSAGE_WARNING_BOX:".varwiz-ui-warning-msgs",UI_MESSAGE_INFO_BOX:".varwiz-ui-info-msgs",UI_MESSAGE_LIST:".msgList",NO_VARIATIONS_LOADED_ROW:"tr#empty-table-no-variations-loaded"},ITK_FIELD_SELECTOR:"#itkField",
HEADER_CONTROL_CLASS:"controlHeader",HEAD_ROW_CLASS:"mt-head",ROW_CONTROLS_CLASS:"rowControls",EDIT_FIELD_CLASS:"editFld",INVALID_CLASS:"invalid",CURRENCY_SYMBOL_ATTR:"currency-symbol",VALUE_ATTR:"value",CELL_COLUMN_ATTR:"data-column",DISABLED_CLASS:"disabled",SELL_YOURS_ROW_CLASS:"sell-yours",ADDED_ROW_CLASS:"added-row",DELETED_ROW_CLASS:"deletedRow",PARENT_ROW_CLASS:"parent-row",StaticColumnKeys:{SKU:"item_sku",EXTERNAL_PRODUCT_ID:"external_product_id",EXTERNAL_PRODUCT_ID_TYPE:"external_product_id_type",
PARENTAGE:"parent_child",ASIN:"asin",QUANTITY:"quantity"},VariationRow_ParentageEnum:{PARENT:"parent",CHILD:"child",OTHER:"other"},VariationRow_RowTypeEnum:{HEADER:"header",NORMAL:"normal"},VariationRow_State:{ADDED:"Added",UPDATED:"Updated",DELETED:"Deleted",FOREIGN:"Foreign",ADOPTED:"Adopted"},TemplateOperationValues:{UPDATE:"Update",PARTIAL_UPDATE:"PartialUpdate",DELETE:"Delete"},SHADOW_PARENT_SKU_PREFIX:"SP",TEMPLATE_OPERATION_KEY:"update_delete",RELATIONSHIP_TYPE_KEY:"relationship_type",VARIATION_RELATIONSHIP:"Variation",
PARENT_SKU_KEY:"parent_sku",LIST_PRICE_KEY:"list_price",STANDARD_PRICE_KEY:"standard_price",ITK_KEY:"item_type",RBN_KEY:"recommended_browse_nodes",VariationRowControls_BtnStates:{SAVE_CANCEL:"Save_Cancel",EDIT_DELETE:"Edit_Delete",EDIT:"Edit",UNDO_DELETE:"UndoDelete",SELL_YOURS:"SellYours"},VariationRowOperations:{EDIT:"Edit",DELETE:"Delete",SAVE:"Save",UNDO_DELETE:"UndoDelete",SELL_YOURS:"SellYours",CANCEL:"Cancel"},ControllerURLs:{SEARCH_URL:"/listing/varwiz/search",POPULATE_URL:"/listing/varwiz/populate",
GENERATE_TEMPLATE_URL:"/listing/varwiz/template",REFRESH_TEMPLATES_URL:"/listing/tabela/varwiz/refresh-template-table"},UIMessageTypes:{WARNING:"WARNING",INFO:"INFO",ERROR:"ERROR"},UILoggingMetrics:{CLIENT_VARWIZ_SEARCH_TIMEOUT:"CLIENT_VARWIZ_SEARCH_TIMEOUT",CLIENT_VARWIZ_SEARCH_FAILURE:"CLIENT_VARWIZ_SEARCH_FAILURE",CLIENT_VARWIZ_USECASE_PREFIX:"CLIENT_VARWIZ_USECASE",useCaseValues:{EXISTING_PARENT:"_EXISTING_PARENT",NEW_PARENT:"_NEW_PARENT",ADOPTED:"_ADOPTED",NOT_ADOPTED:"_NOT_ADOPTED",ADDED:"_ADDED",
NOT_ADDED:"_NOT_ADDED"}},constraints:{STRING_MAX:"string_max",STRING_MIN:"string_min",STRING_MAX_BYTE:"string_maxByte",STRING_PATTERN:"string_pattern",DECIMAL_MAX:"decimal_max",DECIMAL_MIN:"decimal_min",DECIMAL_MAX_FRACTION:"decimal_maxFraction",DECIMAL_MAX_DIGITS:"decimal_maxDigits",INTEGER_MAX:"integer_max",INTEGER_MIN:"integer_min",INTEGER_MAX_DIGITS:"integer_maxDigits"},constraintTypes:{INTEGER:"integer",DECIMAL:"decimal",STRING:"string"},INFO_ICON_CLASS:"varwiz-info-icon",infoPopoverClasses:{ASIN_SEARCH:"asin-search-popover-info",
SKU:"sku-popover-info",EXTERNAL_PRODUCT_ID_TYPE:"external-product-id-popover-info",ITK_RBN_INFO_CLASS:"itk-rbn-popover-info"}}});h.when("A","varwiz-constants","search-generate-table-container-factory","ui-message-util","info-popover-list","ready").execute(function(e,a,c,d,b){e=$("#variation_wizard_content_box");a=$("#varwizard_accordion");a===r?(console.log("ERROR: Attempted to find accordion when varwiz accordion element is undefined."),a=void 0):(a=a.find("div[data-a-accordion-row-name='main-generate-uc1']"),
0===a.length&&(console.log("ERROR: Couldn't find accordion box element with attribute value:main-generate-uc1"),a=void 0));a||(a=e);c.createContainerInstance(a);b.setupInfoPopups()});h.when("A").execute(function(e){e.on("a:dropdown:selected:feedCountDropDown",function(a){$(location).attr("href","/listing/varwiz?template_count="+a.value)})});h.when("A","varwiz-constants","ready").register("template-table",function(e,a){function c(){l&&!n&&(n=!0,m.show(),e.post(p,{timeout:2E4,contentType:"application/json; charset-utf-8",
success:d,error:b}))}function d(a){n=!1;a=$(a).html();q.html(a);m.hide();f();h()}function b(a){n=!1;console.log("Failed to refresh template table.");m.hide()}function f(){k===r?console.log("ERROR: Unable to find table overlay for template table because expander hasn't been defined."):m=k.find(".mt-loading-overlay")}function h(){var a=k.find("td[data-column='dateTime']");$.each(a,function(a,b){var c=Number($(b).text()),c=new Date(c);$(b).html(c.toString())})}var k,v,g,m,p=a.ControllerURLs.REFRESH_TEMPLATES_URL,
q,l=!1,n=!1;0<$("#template-table").length&&(k=$("div[data-a-expander-name='download_a_created_variation_expander']"),v=k.find("a.a-link-section-expander"),g=v.find("i.a-icon"),q=$("#template-table"),f(),setInterval(c,3E4),h(),l=!0,c());return{expand:function(){l&&g.hasClass("a-icon-section-expand")&&v.click()},refresh:c}});h.when("varwiz-constants","ready").register("ui-message-util",function(e){function a(a){function b(){return 0===g.length}function c(){b()?d.hide():(f.html(""),d.show(),
$.each(g,function(a,b){var c=$("<li>");c.html(b);f.append(c)}))}var d=a,f=d.find(e.selectors.UI_MESSAGE_LIST),g=[];return{addMessage:function(a){g.push(a);c()},clear:function(){g=[];c()},isEmpty:b}}function c(){p.clear();q.clear();m.clear();$("#ui-cmf-msg-container").hide()}var d=e.UIMessageTypes.ERROR,b=e.UIMessageTypes.WARNING,f=e.UIMessageTypes.INFO,h=e.selectors.UI_MESSAGE_ERROR_BOX,k=e.selectors.UI_MESSAGE_WARNING_BOX,v=e.selectors.UI_MESSAGE_INFO_BOX,g=$(e.selectors.UI_MESSAGE_CONTAINER),h=
g.find(h),k=g.find(k),v=g.find(v),m=new a(k),p=new a(h),q=new a(v),v={addMessage:function(a,c){console.log("Add message:"+c+" ("+a+")");switch(a){case b:m.addMessage(c);break;case d:p.addMessage(c);break;case f:q.addMessage(c);break;default:console.log("Unknown message type:"+a+". Displaying as info."),q.addMessage(c)}},clearAll:c,containerIsEmpty:function(a){switch(a){case b:return m.isEmpty();case d:return p.isEmpty();case f:return q.isEmpty();default:return console.log("Unknown message type:"+
a+". Returning true for is empty."),!0}}};c();g.show();return v});h.when("A","varwiz-constants","ready").register("row-state-factory",function(e,a){function c(c){function b(a){e=h;h=a}var e=c,h=c,k=a.VariationRow_State.ADOPTED,v=a.VariationRowOperations.SAVE,g=a.VariationRowOperations.CANCEL,m=a.VariationRowOperations.SELL_YOURS;return{getState:function(){return h},setState:b,transitionRowState:function(a){switch(a){case g:a=h;h=e;e=a;break;case m:b(k);break;case v:h===k&&b(k)}}}}return{createRowState:function(a){return new c(a)}}});
h.when("A","varwiz-constants","ready").register("row-control-btn-state-factory",function(e,a){function c(c){function b(a){e=h;h=a}var e=c,h=c,k=a.VariationRowControls_BtnStates.SAVE_CANCEL,m=a.VariationRowControls_BtnStates.EDIT_DELETE,g=a.VariationRowControls_BtnStates.EDIT,r=a.VariationRow_State.ADDED,p=a.VariationRowOperations.EDIT,q=a.VariationRowOperations.SAVE,l=a.VariationRowOperations.CANCEL,n=a.VariationRowOperations.SELL_YOURS;return{getState:function(){return h},setState:b,
transitionState:function(a,c,d){switch(a){case l:a=h;h=e;e=a;break;case n:case p:b(k);break;case q:c===r?b(m):b(g)}}}}return{createBtnState:function(a){return new c(a)}}});h.when("ready").register("sku-generator",function(){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");return{generateSKU:function(a){var c="";null!==a&&a!==r&&(c=8<a.length?a.substr(0,8):a);a=c;var c=20-a.length,d="";0<a.length&&(d+="-",c--);for(var b=0;b<c-1;b++)var f=Math.floor(Math.random()*e.length),d=d+e[f];
return a+d}}});h.when("varwiz-constants","a-popover","ready").register("info-popover-list",function(e,a){function c(a,b){return{getMsg:function(){return b},getSelector:function(){return a}}}var d=e.infoPopoverClasses.SKU,b=e.infoPopoverClasses.EXTERNAL_PRODUCT_ID_TYPE,f=e.infoPopoverClasses.ITK_RBN_INFO_CLASS,h=[new c("."+e.infoPopoverClasses.ASIN_SEARCH,$("#search-asin-info-popover")),new c("."+d,$("#sku-info-popover")),new c("."+b,$("#external-product-info-popover")),new c("."+f,$("#itk-rbn-product-info-popover"))];
return{setupInfoPopups:function(){for(var b=0;b<h.length;b++)for(var c=h[b],d=$(c.getSelector()),e=0;e<d.length;e++){var f=$(d[e]),q={};q.inlineContent=c.getMsg();q.position="triggerTop";a.create(f,q)}}}});h.when("A","varwiz-constants","variation-table-factory","ui-message-util","info-popover-list","template-table","script-evaluator","itk-component","client-logger","sanitize-util","ready").register("search-generate-table-container-factory",function(e,a,c,d,b,f,m,k,v,g){function r(){function p(){A=
w.find(".mt-loading-overlay")}function q(){E.val(g.stripTags(E.val()));var a=E.val().trim();if(""!==a){P=0;A.show();I.addClass(F);d.clearAll();var c=!z.hasClass(F),e=!x.hasClass(F);H();console.log("Search text: "+a);$.ajax({url:T,type:"GET",data:{searchText:a},timeout:12E4}).pipe(function(a){B("Search Success",a,!0);h.when("OlympusDebugConsole").execute(function(b){a&&a.requestDebugInfoJsonObjectList&&0<a.requestDebugInfoJsonObjectList.length&&a.requestDebugInfoJsonObjectList.forEach(function(a){b.addRequest(JSON.parse(a))})});
a&&a.uiMessageObjList&&0<a.uiMessageObjList.length&&a.uiMessageObjList.forEach(function(a){d.addMessage(a.type,a.message)});ba=a&&a.variationDetailsList||[];aa=Math.ceil(ba.length/50);Y[P]=n(P);return Y[P]}).pipe(function(){for(var a=0;a<aa;a++)a!==P&&(Y[a]=n(a));if(1<aa){for(var a=$('<ul class="a-pagination">'),c=0;c<aa;c++){var d=$("<a>",{href:"#",text:c+1});d.click(l(c));var e=$("<li>");e.append(d);c===P&&e.addClass("a-selected");a.append(e);ga[c]=e}c=$('<div id="status-table-pagination" class="a-text-center">');
c.append(a);U=$('<div class="mt-pagination">');U.append(c);$("#variation-table div.mt-foot-pagi.clearfix").append(U)}V.hasSuccessfullyLoaded()&&(z.removeClass(F),x.removeClass(F),U&&U.removeClass(F));b.setupInfoPopups();I.removeClass(F);p();A.hide()},function(a,b){B("Populate Initial Page Error",a,!1);"timeout"===b||"Gateway Timeout"===b?v.logCount(C):v.logCount(L);A.hide();I.removeClass(F);c&&z.removeClass(F);e&&x.removeClass(F);var f=$("#unexpected-during-search-error-msg").text();d.addMessage(y,
f)})}}function l(a){return function(){ga[P].removeClass("a-selected");P=a;ga[P].addClass("a-selected");A.show();Y[P].pipe(function(){V.changePage(P);A.hide()});return!1}}function n(a){var b=50*a,b=ba.slice(b,b+50);return $.ajax({url:M,type:"POST",contentType:"application/json",data:JSON.stringify(b),timeout:12E4}).pipe(function(b){B("Populate Page Success",b,!0);m.execResponseScript(b);V.renderFromSearchResponse(b,a);0===a&&k.processSearchResponse(b)})}function B(a,b,c){h.when("OlympusDebugConsole").execute(function(d){var e=
{},f={};c?f.responseText=b:(e.params=b.params,e.pollTimer=b.pollTimer,b.http&&(f.statusText=b.http.statusText,f.statusCode=b.http.status,e.url=b.http.responseURL));d.addRequest({name:"AJAX Response "+a,request:e,response:f})})}function D(){V.addRow()}function t(){if(k.isITKSupported()&&!k.hasSelectedITK()){var a=$("#select-itk-before-template-generation").text();d.addMessage(y,a)}else{d.clearAll();var a=V.toJSON(),b=JSON.stringify(a);x.addClass(F);p();A.show();u();$.when.apply($,Y).pipe(function(){e.post(N,
{params:{variationRows:b},timeout:3E4,success:function(a){B("Template Generate Success",a,!0);d.clearAll();m.execResponseScript(a);x.removeClass(F);f.expand();f.refresh();$("#ui-cmf-msg-container").show();p();A.hide()},error:function(a){B("Template Generate Error",a,!1);d.clearAll();m.execResponseScript(a);x.removeClass(F);p();A.hide()}})})}}function u(){var b=V.getParentRow(),c=V.getTableRows(),b=b.getState()!==K,d=c.some(function(b){return b.getState()===a.VariationRow_State.ADDED}),c=c.some(function(b){return b.getState()===
a.VariationRow_State.ADOPTED}),e=O,e=e+(b?Q:G),e=e+(c?Z:ea),e=e+(d?da:R);v.logCount(e)}function H(){x.addClass(F);z.addClass(F);U&&U.addClass(F)}var w,x,I,z,E,A,F=a.DISABLED_CLASS,T=a.ControllerURLs.SEARCH_URL,M=a.ControllerURLs.POPULATE_URL,N=a.ControllerURLs.GENERATE_TEMPLATE_URL,y=a.UIMessageTypes.ERROR,C=a.UILoggingMetrics.CLIENT_VARWIZ_SEARCH_TIMEOUT,L=a.UILoggingMetrics.CLIENT_VARWIZ_SEARCH_FAILURE,K=a.VariationRow_State.FOREIGN,O=a.UILoggingMetrics.CLIENT_VARWIZ_USECASE_PREFIX,Q=a.UILoggingMetrics.useCaseValues.EXISTING_PARENT,
G=a.UILoggingMetrics.useCaseValues.NEW_PARENT,R=a.UILoggingMetrics.useCaseValues.NOT_ADDED,da=a.UILoggingMetrics.useCaseValues.ADDED,ea=a.UILoggingMetrics.useCaseValues.NOT_ADOPTED,Z=a.UILoggingMetrics.useCaseValues.ADOPTED,V,P=0,aa=0,Y=[],ba=[],U,ga=[],ma={notifyUpdatedEditCount:function(a){0<a?H():(z.removeClass(F),x.removeClass(F),U&&U.removeClass(F))},find:function(a){return w.find(a)},init:function(a){w=a;x=w.find("#generate-template-btn");z=w.find("#add-row-btn");I=w.find(".searchButton");E=
w.find("#varwiz-search-text");I.click(q);x.click(t);z.click(D);p();E.val("");H();V=c.createTable(ma)}};return ma}console.log("Container Factory Registered");return{createContainerInstance:function(a){var b=new r;b.init(a);return b}}});h.when("A","a-popover","varwiz-constants","ready").register("cell-validator-factory",function(e,a,c){function d(){function c(a,b){if(!b)return!0;switch(a){case B:return E.test(b);case S:return A.test(b);case t:return!0;default:return!0}}function d(a,b,c){switch(c){case f:if(a.length>
b)return!1;break;case h:if(a.length<b)return!1;break;case k:if(a.length>b)return!1;break;case m:case q:if(Number(a)>b)return!1;break;case g:case l:if(Number(a)<b)return!1;break;case D:if(a.split(z)[1]&&a.split(z)[1].length>b)return!1;break;case p:case n:if(a.length>b)return!1}return!0}var e,z,E=/^([\-]){0,1}\d+$/,A;return{init:function(a,b){e=a;z=b;A=new RegExp("^((\\d+(["+z+"]\\d+))$|^\\d+$)","");e[u][D]=2},validateCell:function(u){var z=$(u).find("input");if(0===z.size())return!0;var A=z.val().trim(),
E=!0,y;u=$(u).attr(b);u=e[u];for(var C in u)if(C!==r&&u.hasOwnProperty(C)){var L=u[C],K;K=C;K=K.startsWith(S)?S:K.startsWith(B)?B:t;if(!c(K,A)){E=!1;C=K;y=$("#table-row-constraint-invalid-entry-violation").text();switch(C){case S:y+=$("#table-row-constraint-decimal-format-violation").text()+A;break;case B:y+=$("#table-row-constraint-integer-format-violation").text()+A;break;default:y+=$("#table-row-constraint-violation-default").text()+A}break}if(!d(A,L,C)){E=!1;A=L;y=$("#table-row-constraint-invalid-entry-violation").text();
switch(C){case f:y+=$("#table-row-constraint-input-not-exceed-character-violation").text()+A;break;case h:y+=$("#table-row-constraint-input-minimum-character-violation").text()+A;break;case k:y+=$("#table-row-constraint-input-maximum-byte-violation").text();break;case m:case q:y+=$("#table-row-constraint-number-max-violation").text()+A;break;case g:case l:y+=$("#table-row-constraint-number-min-violation").text()+A;break;case D:y+=$("#table-row-constraint-input-decimal-fraction-violation").text()+
A;break;case p:case n:y+=$("#table-row-constraint-input-max-digit-violation").text()+A}break}}E?(z.removeClass(H),a.remove(z)):(z.addClass(H),A={inlineContent:y,position:"triggerTop"},a.remove(z),a.create(z,A));return E}}}var b=c.CELL_COLUMN_ATTR,f=c.constraints.STRING_MAX,h=c.constraints.STRING_MIN,k=c.constraints.STRING_MAX_BYTE,m=c.constraints.DECIMAL_MAX,g=c.constraints.DECIMAL_MIN,D=c.constraints.DECIMAL_MAX_FRACTION,p=c.constraints.DECIMAL_MAX_DIGITS,q=c.constraints.INTEGER_MAX,l=c.constraints.INTEGER_MIN,
n=c.constraints.INTEGER_MAX_DIGITS,B=c.constraintTypes.INTEGER,S=c.constraintTypes.DECIMAL,t=c.constraintTypes.STRING,u=c.LIST_PRICE_KEY,H=c.INVALID_CLASS;return{createCellValidator:function(a,b){var c=b===r?".":b,e=new d(a,c);e.init(a,c);return e}}});h.when("ready").register("script-evaluator",function(e){console.log("Register script evaluator");return{execResponseScript:function(a){a=$(a).filter("script.UIMessageScript,script.debug-info");for(var c=0;c<a.length;c++){var d=a[c].innerHTML,
d=d.replace(/[\u2029|\u2028|\r|\n]/g," ");$.globalEval(d)}}}});h.when("varwiz-constants","auto-complete","ready").register("itk-component",function(e,a){function c(a){m.text(a)}function d(a){var b=[];Object.keys(a).forEach(function(c){var d=!$.isNaN(c),e={};e.value=c;if(d){var d=a[c],f=d.lastIndexOf(">"),f=d.substr(f+1).trim();e.label=f+" : "+c;e.path=d}else e.label=c,e.path="";b.push(e)});b.sort(function(a,b){return a.label.localeCompare(b.label)});return b}console.log("ITK component registered.");
var b=e.ITK_FIELD_SELECTOR,f=!1,h,k,m,g;h=$(".itkContainer");k=$(b);m=$("#rbnPathFld");h.hide();return{processSearchResponse:function(b){try{var e=$(b).find("#validIdentifiers");if(f=0!==e.length){var q=e.val(),l=JSON.parse(q),n=d(l),r=[],S=[],t=[];n.forEach(function(a){r.push(a.label);S.push(a.value);t.push(a.path)});1<n.length?(g=a.setupAutoComplete(k,S,r,t,c),h.show()):1===n.length&&(g=a.setupAutoComplete(k,S,r,t,c),h.hide(),k.val(n[0].value));var u=g.getInstance(),H=u.close;u.close=function(){g.currentValueIsInOptionsSet()||
m.text("");H.apply(this,arguments)}}else h.hide()}catch(w){console.debug("There was an issue processing the ITK select container."+w.message),f=!1}},isITKSupported:function(){return f},getSelectedITK:function(){return g.getValue()},hasSelectedITK:function(){return g.currentValueIsInOptionsSet()}}});h.when("varwiz-constants","ready").register("price-formatter",function(e){var a=[",","."];return{formatPriceStr:function(c,d){var b;a:{var e=c.length-1;for(b=e;b>=e-2;b--)if(-1!==a.indexOf(c[b]))break a;
b=-1}if(-1===b)return c.replace(/\D/g,"");e=c.substring(0,b);b=c.substring(b+1);e=e.replace(/\D/g,"");e=0===e.length?"0":e;for(b=b.replace(/\D/g,"");2>b.length;)b+="0";return e+d+b}}});h.when("jQueryUI-autocomplete","ready").register("auto-complete",function(){function e(a,c,d){for(var b=[],e=Math.min(a.length,c.length),h=0;h<e;h++){var k={};k.value=a[h];k.label=c[h];d!==r&&d.length>h&&(k.focusData=d[h]);b.push(k)}return b}return{setupAutoComplete:function(a,c,d,b,f){function h(){var b=
a.val(),e=d.indexOf(b);return-1!==e?c[e]:b}function k(a){f!==r&&a.focusData!==r&&f(a.focusData)}var m;a.val("");var g;try{d===r&&(d=c);var D=e(c,d,b);m=a.autocomplete({source:D,minLength:0,select:function(a,b){g=b.item;$(this).val(g.label);k(g);return!1},focus:function(a,b){$(this).data("uiAutocomplete");k(b.item)}}).focus(function(){$(this).autocomplete("search")});m=a.data("uiAutocomplete");a.bind("autocompleteopen",function(a,b){var c=$(".ui-autocomplete.ui-menu").width()+"px";$(".ui-autocomplete.ui-menu .ui-menu-item a").css("min-width",
c)});m._renderItem=function(a,b){var c=$("<li>");c.append("<a>"+b.label+"</a>");c.appendTo(a);return c}}catch(p){console.error("Could not set up autocomplete element."+p.message)}return{getInstance:function(){return m},getValue:h,currentValueIsInOptionsSet:function(){var a=h();return-1!==c.indexOf(a)}}}}})});