(function(f){var h=window.AmazonUIPageJS||window.P,l=h._namespace||h.attributeErrors,a=l?l("SellerCentralFeeDiscountsAssets"):h;a.guardFatal?a.guardFatal(f)(a,window):a.execute(function(){f(a,window)})})(function(f,h,l){f.when("A","initialize-globalize-SCFD").register("currency-translator-SCFD",function(a,c){return function(){var a=this;a.globalize=c;var e=/[\x20]/g;this.formatCurrency=function(b){return a.globalize.currencyFormatter(b).replace(/[^\d.,\s-]/g,"").trim()};this.parseCurrency=function(b){return b&&
+a.globalize.instance.numberParser()(b.toString().replace(e,"Â ")).toFixed(c.currencyPrecision)}}});f.when("A","currency-translator-SCFD","ready").register("feediscount-action-library",function(a,c){var d=new c,e=function(b){a.$.ajax({url:"/feediscounts/metrics",tryCount:0,retryLimit:3,method:"GET",dataType:"text/html",data:b,timeout:1E4,success:function(){},error:function(b,d,c){200!==b.status&&(this.tryCount++,this.tryCount<=this.retryLimit&&(this.timeout*=2,a.$.ajax(this)))}})};return{matchPrice:function(b){a.ajax("/feediscounts/setprice",
{method:"post",params:{clientID:b.clientID,currencyCode:b.currencyCode,sku:b.sku,price:b.suggestedPrice,topToken:b.topToken,shipping:b.shipping,endDate:b.endDate,discountRate:b.discountRate},cache:!1,success:function(d){a.$("#fd-widget-price-content-"+b.topTokenHash).html(d)},error:function(){a.$("#fd-widget-status-message-"+b.topTokenHash).removeClass("aok-hidden");a.$("#fd-widget-status-message-"+b.topTokenHash).removeClass("a-hidden")}})},matchPricePage:function(b){a.ajax("/feediscounts/setprice/page",
{method:"POST",params:{clientID:b.clientID,currencyCode:b.currencyCode,sku:b.sku,price:b.suggestedPrice,topToken:b.topToken,shipping:b.shipping,endDate:b.endDate,discountRate:b.discountRate},chunk:function(d){var c=d[2];switch(d[0]){case "updatePricePage":a.$("#fd-applied-alert-"+b.topTokenHash).removeClass("aok-hidden");a.$("#fd-product-table-row-"+b.topTokenHash).addClass("fee-discount-table-row-applied");a.$("#fd-nudge-action-match-price-section-"+b.topTokenHash).addClass("section-hidden");a.$("#fd-nudge-action-seller-price-"+
b.topTokenHash).html(c);break;case "updatePopoverPricePage":a.$("#fd-update-popover-seller-price-"+b.topTokenHash).html(c)}},success:function(a){},error:function(a,b,d){}})},updatePricePageValidate:function(b){var c=a.$("#update-popover-new-price-"+b.topTokenHash).val(),c=d.parseCurrency(c);if(isNaN(c))return a.$("#update-popover-price-alert-"+b.topTokenHash).addClass("section-collapsed"),a.$("#update-popover-price-error-"+b.topTokenHash).removeClass("section-collapsed"),-1;a.$("#update-popover-price-error-"+
b.topTokenHash).addClass("section-collapsed");if(Number(c)>Number(b.suggestedPrice))return a.$("#update-popover-price-alert-"+b.topTokenHash).removeClass("section-collapsed"),1;a.$("#update-popover-price-alert-"+b.topTokenHash).addClass("section-collapsed");return 0},updatePricePage:function(b){var c=this.updatePricePageValidate(b);if("invalid"!==c){var g=a.$("#update-popover-new-price-"+b.topTokenHash).val(),g=d.parseCurrency(g);a.ajax("/feediscounts/setprice/page",{method:"POST",params:{clientID:b.clientID,
currencyCode:b.currencyCode,sku:b.sku,price:g,topToken:b.topToken,shipping:b.shipping,endDate:b.endDate,discountRate:b.discountRate},chunk:function(d){var g=d[2];switch(d[0]){case "updatePricePage":0===c?(a.$("#fd-applied-alert-"+b.topTokenHash).removeClass("aok-hidden"),a.$("#fd-product-table-row-"+b.topTokenHash).addClass("fee-discount-table-row-applied"),a.$("#fd-nudge-action-match-price-section-"+b.topTokenHash).addClass("section-collapsed")):(a.$("#fd-applied-alert-"+b.topTokenHash).addClass("aok-hidden"),
a.$("#fd-product-table-row-"+b.topTokenHash).removeClass("fee-discount-table-row-applied"),a.$("#fd-nudge-action-match-price-section-"+b.topTokenHash).removeClass("section-collapsed"));a.$("#fd-nudge-action-seller-price-"+b.topTokenHash).html(g);break;case "updatePopoverPricePage":a.$("#fd-update-popover-seller-price-"+b.topTokenHash).html(g);break;case "updateActionPage":0===c?a.$("#update-popover-price-success-"+b.topTokenHash).removeClass("section-collapsed"):a.$("#update-popover-price-success-"+
b.topTokenHash).addClass("section-collapsed"),a.$("#update-popover-price-result-"+b.topTokenHash).html(g),a.$("#update-popover-success-section-"+b.topTokenHash).removeClass("section-collapsed"),a.$("#update-popover-input-section-"+b.topTokenHash).addClass("section-collapsed")}},success:function(a){},error:function(a,b,d){}})}},skipDiscount:function(b){a.$("#fd-product-table-row-"+b.topTokenHash).find("td").addClass("aok-hidden");a.$("#fd-skip-alert-"+b.topTokenHash).removeClass("aok-hidden");a.ajax("/feediscounts/skipdiscount",
{method:"post",params:{clientID:b.clientID,promotionType:b.promotionType,conditionType:b.conditionType,conditionValue:b.conditionValue,topToken:b.topToken},cache:!1,success:function(d){setTimeout(function(){a.$("#fd-product-table-row-"+b.topTokenHash).remove()},2E4)},error:function(){setTimeout(function(){a.$("#fd-product-table-row-"+b.topTokenHash).remove()},2E4)}})},listItem:function(a){h.open("/abis/Display/ItemSelected?asin="+a.q,"")},getFeePreview:function(b){a.$("#fd-widget-price-preview-details-"+
b.topTokenHash).addClass("aok-hidden");a.$("#fd-widget-price-preview-details-"+b.topTokenHash).addClass("a-hidden");a.$("#fd-widget-price-preview-spinner-"+b.topTokenHash).removeClass("aok-hidden");a.$("#fd-widget-price-preview-spinner-"+b.topTokenHash).removeClass("a-hidden");var c=a.$("#fd-widget-price-preview-input-"+b.topTokenHash).val(),c=d.parseCurrency(c);isNaN(c)?(a.$("#fd-widget-price-already-previewed-"+b.topTokenHash).val(1),a.$("#fd-widget-price-preview-spinner-"+b.topTokenHash).addClass("aok-hidden"),
a.$("#fd-widget-price-preview-spinner-"+b.topTokenHash).addClass("a-hidden"),a.$("#fd-widget-price-preview-details-"+b.topTokenHash).removeClass("aok-hidden"),a.$("#fd-widget-price-preview-details-"+b.topTokenHash).removeClass("a-hidden")):a.ajax("/feediscounts/feepreview",{method:"post",params:{clientID:b.clientID,currencyCode:b.currencyCode,asin:b.asin,sellerPreviewPrice:c,fulfillmentNetwork:b.fulfillmentNetwork,sellerShippingPrice:b.shipping},cache:!1,success:function(d){a.$("#fd-widget-price-preview-fees-"+
b.topTokenHash).html(d.totalFees);a.$("#fd-widget-price-preview-promotions-"+b.topTokenHash).html(d.totalDiscounts);a.$("#fd-widget-price-preview-netproceeds-"+b.topTokenHash).html(d.netProceeds);a.$("#fd-widget-price-already-previewed-"+b.topTokenHash).val(1);a.$("#fd-widget-price-preview-spinner-"+b.topTokenHash).addClass("aok-hidden");a.$("#fd-widget-price-preview-spinner-"+b.topTokenHash).addClass("a-hidden");a.$("#fd-widget-price-preview-details-"+b.topTokenHash).removeClass("aok-hidden");a.$("#fd-widget-price-preview-details-"+
b.topTokenHash).removeClass("a-hidden")},error:function(){a.$("#fd-widget-price-already-previewed-"+b.topTokenHash).val(1);a.$("#fd-widget-price-preview-spinner-"+b.topTokenHash).addClass("aok-hidden");a.$("#fd-widget-price-preview-spinner-"+b.topTokenHash).addClass("a-hidden");a.$("#fd-widget-price-preview-details-"+b.topTokenHash).removeClass("aok-hidden");a.$("#fd-widget-price-preview-details-"+b.topTokenHash).removeClass("a-hidden")}})},actionTracking:function(a,d,c){c="undefined"===typeof c?
"":c;e({ref_:null===typeof c?"":c,pageType:a,subPageType:d})},ajaxTimeTracking:function(a){e({clientAjaxTime:a})},getMoreDiscounts:function(b,d){a.$("#fd-page-show-more-discounts").hide();a.ajax("/feediscounts/dashboard/ajax/get-more-discounts",{method:"POST",params:{topToken:b,promotionType:d},chunk:function(b){var d=b[1],c=b[2];switch(b[0]){case "updateValue":a.$(d).val(c);c||a.$("#fd-page-show-more-discounts").remove();break;case "after":1>a.$(d).length&&(d="#fd-page-discount-table>tbody>tr"),
a.$(d).last().after(c)}},success:function(b){a.$("#get-more-discounts-spinner").css("display","none");a.$("#fd-page-show-more-discounts").show()},error:function(b,d,c){a.$("#get-more-discounts-spinner").css("display","none");a.$("#fd-page-show-more-discounts").remove()}})},getPageFeePreview:function(b){a.$("#fd-fee-preview-details-"+b.topTokenHash).addClass("aok-hidden");a.$("#fd-fee-preview-spinner-"+b.topTokenHash).removeClass("aok-hidden");var c=a.$("#fd-fee-preview-input-"+b.topTokenHash).val(),
c=d.parseCurrency(c);isNaN(c)?(a.$("#fd-fee-already-previewed-"+b.topTokenHash).val(1),a.$("#fd-fee-preview-spinner-"+b.topTokenHash).addClass("aok-hidden"),a.$("#fd-fee-preview-details-"+b.topTokenHash).removeClass("aok-hidden")):a.ajax("/feediscounts/feepreview",{method:"post",params:{currencyCode:b.currencyCode,asin:b.asin,sellerPreviewPrice:c,fulfillmentNetwork:b.fulfillmentNetwork,sellerShippingPrice:b.shipping},cache:!1,success:function(c){a.$("#fd-fee-preview-fees-"+b.topTokenHash).html(c.totalFees);
a.$("#fd-fee-preview-promotions-"+b.topTokenHash).html(c.totalDiscounts);a.$("#fd-fee-preview-netproceeds-"+b.topTokenHash).html(c.netProceeds);a.$("#fd-fee-already-previewed-"+b.topTokenHash).val(1);a.$("#fd-fee-preview-spinner-"+b.topTokenHash).addClass("aok-hidden");a.$("#fd-fee-preview-details-"+b.topTokenHash).removeClass("aok-hidden")},error:function(){a.$("#fd-fee-already-previewed-"+b.topTokenHash).val(1);a.$("#fd-fee-preview-spinner-"+b.topTokenHash).addClass("aok-hidden");a.$("#fd-fee-preview-details-"+
b.topTokenHash).removeClass("aok-hidden")}})}}});f.when("A","globalize","cldr-data-bower:supplemental:likely-subtags","cldr-data-bower:supplemental:numbering-systems","cldr-data-bower:supplemental:currency-data","cldr-data-bower:main:numbers","cldr-data-bower:main:currencies","ready").register("initialize-globalize-SCFD",function(a,c,d,e,b,f,g){var k=a.state("globalize-config"),h="en";a="USD";c.load(f,g,e,d,b);k&&k.locale&&k.currencyCode&&(h=k.locale,a=k.currencyCode);c=c(h);d=c.currencyFormatter(a);
e=0;b=d(0).toString().replace(/[^\d.,]/g,"").split(/[,.]/);1<b.length&&(e=b[1].length);return{instance:c,currencyFormatter:d,currencyPrecision:e}});f.when("A","feediscount-action-library","ready").execute(function(a,c){a.declarative("fd-match-price","click",function(a){c.matchPrice(a.data)});a.declarative("fd-widget-fee-preview-expander","click",function(d){"0"===a.$("#fd-widget-price-already-previewed-"+d.data.topTokenHash).val()&&c.getFeePreview(d.data)});a.declarative("fd-widget-fee-preview",
"click",function(a){c.getFeePreview(a.data)});a.declarative("fd-page-fee-preview-expander","click",function(d){"0"===a.$("#fd-fee-already-previewed-"+d.data.topTokenHash).val()&&c.getPageFeePreview(d.data)});a.declarative("fd-page-fee-preview","click",function(a){c.getPageFeePreview(a.data)});a.$("body").delegate(".fd-widget-popover-asin-selection","click",function(){c.actionTracking("FeeDiscountsWidget","asin-selection","map_fdw_cl_as")});a.$("body").delegate(".fd-widget-popover-brand-selection",
"click",function(){c.actionTracking("FeeDiscountsWidget","brand-selection","map_fdw_cl_bs")});a.$("body").delegate(".fd-widget-popover-category-selection","click",function(){c.actionTracking("FeeDiscountsWidget","category-selection","map_fdw_cl_cs")});a.$("body").delegate(".fd-widget-popover-myi-asin-selection","click",function(){c.actionTracking("FeeDiscountsWidget","myi-asin-selection","map_fdw_cl_myias")});a.$("body").delegate(".fd-widget-popover-myi-pricing-match","click",function(){c.actionTracking("FeeDiscountsWidget",
"myi-pricing-match","map_fdw_cl_myipm")});a.$("body").delegate(".fd-widget-popover-pricing-match","click",function(){c.actionTracking("FeeDiscountsWidget","pricing-match","map_fdw_cl_pm")});a.$("div.feeDiscountWidgetAjaxPlaceholder").each(function(d,e){var b=a.$(e).data("asin"),f=a.$(e).data("clientid"),g=0;a.$.ajax("/feediscounts",{method:"GET",data:{asin:b,clientID:f},timeout:6E3,beforeSend:function(){g=(new Date).getTime()},success:function(b){try{var d=JSON.parse(b.substring(0,b.length-3))[0];
a.$(e).replaceWith(d);c.ajaxTimeTracking((new Date).getTime()-g)}catch(f){a.$(e).remove(),c.ajaxTimeTracking((new Date).getTime()-g)}},error:function(){a.$(e).remove();c.ajaxTimeTracking((new Date).getTime()-g)}})})});f.when("A","feediscount-action-library","ready").execute(function(a,c){a.declarative("get-more-discounts","click",function(d){d=a.$("#fd-page-pagination-token").val();var e=a.$("#fd-page-promotion-type").val();d&&(a.$("#get-more-discounts-spinner").css("display","block"),
c.getMoreDiscounts(d,e))});a.declarative("fd-match-price-page","click",function(a){c.matchPricePage(a.data)});a.declarative("fd-update-price-page","click",function(a){c.updatePricePage(a.data)});a.declarative("fd-update-price-page-validate","change keydown keyup keypress",function(a){c.updatePricePageValidate(a.data)});a.declarative("fd-skip-discount","click",function(a){c.skipDiscount(a.data)});a.declarative("fd-list-item","click",function(a){c.listItem(a.data)})});f.when("A","a-popover","ready").execute(function(a,
c){a.declarative("fd-update-price-page-close-button","click",function(a){c.get("update-popover-"+a.data.topTokenHash).hide()});a.declarative("fd-update-price-page-ok-button","click",function(d){a.$("#update-popover-success-section-"+d.data.topTokenHash).addClass("section-collapsed");a.$("#update-popover-input-section-"+d.data.topTokenHash).removeClass("section-collapsed");c.get("update-popover-"+d.data.topTokenHash).hide()})})});